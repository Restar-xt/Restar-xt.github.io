---
title: 光学系统设计第一章①-费马原理三种表述与高斯光学
tags: [光学系统设计]
categories: [光设理论基础]
date: 2025-7-31
description: 本笔记参考浙江大学-李晓彤老师-光学系统设计课程
articleGPT: 这是光学系统设计第一章笔记，主要介绍费马原理、拉格朗日表述、哈密顿表述与高斯光学，是光学系统设计的理论基础
references:
  - title: 浙江大学光学系统设计 李晓彤老师 2025春夏学期
  - url: https://classroom.zju.edu.cn/livingroom?course_id=72005&sub_id=1539825&tenant_code=112
   
---


# 光学系统设计第一章① 费马原理三种表述与高斯光学

> **参考书目：**  
> 《工程光学》（第4版）                 &ensp;      郁道银 谈恒英  
> 《几何光学·像差·光学设计》（第5版）         &ensp;&ensp;&ensp;&ensp; 李晓彤 岑兆丰
>
> **参考视频：**\
> 学在浙大-智云学堂-李晓彤老师《光学系统设计》 2024-2025-2 工程师学院
>
> **课程概述：**\
> 主要围绕原理、设计要求与设计方法。主要包括绪论、高斯光学、初级像差理论、光学系统结构设计、光学系统质量评价、光学系统中的特殊面形或元件、特殊光学系统设计。

## 1.费马原理-极端光程定律

### 光程的概念

$$S=\int_{P\underset{c}\rightarrow Q} n(x,y,z) ds$$
上述公示的物理意义：空间上某点$P$到某点$Q$严格按照路径$c$的光程，是光程计算的一般化，适用于所有介质情况。从公式可以看出，给定路径后，两点间的光程等于空间折射率在路径上的积分。

对于各向同性均匀介质，光程等于折射率×路径。一般而言，
$$\frac{S}{c}=\frac{几何路程 \cdot n}{c}=\frac{几何路程}{v}=t$$
即：
$$S=ct$$

### 费马原理

连接给定点$P$和$Q$有许多路径，而光线只沿着光程为极值的路径进行传播，即：
$$\delta \int_{P}^{Q}n(x,y,z)ds=0$$
极值也有三种情况，极大值、极小值、稳定值。

### 利用费马原理推导折射定律

![示意图](https://picui.cn/thumbnails/44659579ae8b146cb4747916f8430888.png)

题目分析：已知$A$与$B$点，必须要求光线从$A$处出发，经过一次折射必须到达$A$点。

证明：$AOB$的光程为:
 $$ S=n\sqrt{x^2+y_{1}^{2}}+n'\sqrt{(L-x)^{2}+y_{2}^2} $$
因为$A$、$B$两点位于不同的介质中，对光线运动进行分解，$y$方向上的距离是固定值，因此$S$只是关于$x$的函数，根据费马原理，光线沿极值传播，因此光程应该是极值，那么 $S$对$x$求导，导数值应该为0
 $$\frac{dS}{dx}=n \frac{x}{\sqrt{x^{2}+y_{1}^{2}}}-n'\frac{x}{\sqrt{(L-x)^{2}+y_{2}^{2}}}=0$$
 $$\because sin i = \frac{x}{\sqrt{x^{2}+y_{1}^{2}}},sin i'=\frac{x}{\sqrt{(L-x)^{2}+y_{2}^{2}}}$$
$$\therefore n\sin i=n'\sin i' $$

### 对于任意曲面（不含衍射面）导出折射定律的折射形式

![示意图](https://picui.cn/thumbnails/7da8d4452302a431cf0a623dc8d47c0e.png)

设折射面是任意曲面$f(x,y,z)=0$，如下图所示：
设$\boldsymbol{A_{0}}$,$\boldsymbol{A_{0}'}$分别是沿入射光线$AP$、折射光线$PB$的单位矢量，$N$是光线与折射曲面交点处的法线矢量。

$P$点坐标为$(x,y,z)$、$A$点坐标为$(x_{1},y_{1},z_{1})$、$B$点坐标为$(x_{2},y_{2},z_{2})$

首先表示入射光线、折射光线的光程：
$$S(x,y,z)=n_{1}d_{1}+n_{2}d_{2}$$
$$d_{1}=\overline{AP}=\sqrt{(x-x_{1})^{2}+(y-y_{1})^{2}+(z-z_{1})^{2}}$$
$$d_{2}=\overline{PB}=\sqrt{(x-x_{2})^{2}+(y-y_{2})^{2}+(z-z_{2})^{2}}$$
若折射点由$P$位移到$P'$，坐标由$(x,y,z)$变为$(x+\delta x,y+\delta y,z+\delta z)$，则光程变化量:
$$\delta S=n_{1}\delta d_{1}+n_{2}\delta d_{2}$$
$$\delta d_{1}=\frac{x-x_{1}}{d_{1}}\delta x+\frac{y-y_{1}}{d_{1}}\delta y+\frac{z-z_{1}}{d_{1}}\delta z$$
$$\delta d_{2}=\frac{x-x_{2}}{d_{2}}\delta x+\frac{y-y_{2}}{d_{2}}\delta y+\frac{z-z_{2}}{d_{2}}\delta z$$
注意，$\frac{x-x_{1}}{d_{1}}$形式其实对应的是沿入射光线$AP$的单位矢量的方向余弦中的$\cos{\alpha}$项，则有：
$$\delta d_{1}=\cos \alpha_{1}\cdot \delta x+\cos \beta_{1}\cdot \delta y+\cos \gamma_{1}\cdot\delta z$$
$$\delta d_{1}=-\cos \alpha_{2}\cdot \delta x-\cos \beta_{2}\cdot \delta y-\cos \gamma_{2}\cdot\delta z$$
考虑到$P$，$P'$都在$f(x,y,z)$平面上，则有：
$$\delta f = \frac{\partial f}{\partial x}\delta x+\frac{\partial f}{\partial y}\delta y+\frac{\partial f}{\partial z}\delta z=0$$
将$\delta z$用$\delta x$、$\delta y$表示：
$$\delta z=-\frac{\frac{\partial f}{\partial x}}{\frac{\partial f}{\partial z}}\delta x-\frac{\frac{\partial f}{\partial y}}{\frac{\partial f}{\partial z}}\delta y$$
又，
$$\delta S=(n_{1}\cos \alpha_{1}-n_{2}\cos \alpha_{2})\delta x+(n_{1}\cos \beta_{1}-n_{2}\cos \beta_{2})\delta y+(n_{1}\cos \gamma_{1}-n_{2}\cos \gamma_{2})(-\frac{\frac{\partial f}{\partial x}}{\frac{\partial f}{\partial z}}\delta x-\frac{\frac{\partial f}{\partial y}}{\frac{\partial f}{\partial z}}\delta y)$$
整理为关于$\delta x$，$\delta y$的等式：
$$
\begin{aligned}
\delta S & = \left[(n_{1}\cos \alpha_{1}-n_{2}\cos \alpha_{2}) - (n_{1}\cos \gamma_{1}-n_{2}\cos \gamma_{2})\dfrac{\dfrac{\partial f}{\partial x}}{\dfrac{\partial f}{\partial z}}\right]\delta x \\
         & + \left[(n_{1}\cos \beta_{1}-n_{2}\cos \beta_{2}) - (n_{1}\cos \gamma_{1}-n_{2}\cos \gamma_{2})\dfrac{\dfrac{\partial f}{\partial y}}{\dfrac{\partial f}{\partial z}}\right]\delta y
\end{aligned}
$$
费马原理要求光程为极值，即$\delta S=0$，而$\delta x$与$\delta y$是任意可变的，故系数为0，可得：
$$\frac{n_{1}\cos \alpha_{1}-n_{2}\cos \alpha_{2}}{\frac{\partial f}{\partial x}}=\frac{n_{1}\cos \beta_{1}-n_{2}\cos \beta_{2}}{\frac{\partial f}{\partial y}}=\frac{n_{1}\cos \gamma_{1}-n_{2}\cos \gamma_{2}}{\frac{\partial f}{\partial z}}=K$$
$K$是一个常数，从而可得：
$$n_{1}\cos{\alpha_{1}}-n_{2}\cos{\alpha_{2}}=K\frac{\partial f}{\partial x}$$
$$n_{1}\cos{\beta_{1}}-n_{2}\cos{\beta_{2}}=K\frac{\partial f}{\partial y}$$
$$n_{1}\cos{\gamma_{1}}-n_{2}\cos{\gamma_{2}}=K\frac{\partial f}{\partial z}$$
将上述三式转变为矢量数乘的形式：
$$n_{1}(\cos{\alpha_{1}},\cos{\beta_{1}},\cos{\gamma_{1}})-n_{2}(\cos{\alpha_{2}},\cos{\beta_{2}},\cos{\gamma_{2}})=K(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y},\frac{\partial f}{\partial z})$$
那么，则得到折射定律的矢量形式：
$$n_{1}\boldsymbol{A_{0}}-n_{2}\boldsymbol{A_{0}'}=K\boldsymbol{N}$$

### 对于含有衍射面情况下折射定律的矢量形式（广义斯涅尔定律）

含有衍射面的情况下，需要增添一个附加光程，光程表达式如下：
$$S=n_{1}d_{1}+n_{2}d_{2}+\Delta S$$
则有：
$$\delta S=n_{1}\delta d_{1}+n_{2}\delta d_{2}+\delta \Delta S$$
$$\delta \Delta S=\frac{\partial \Delta S}{\partial x}\delta x+\frac{\partial\Delta S}{\partial y}\delta y+\frac{\partial \Delta S}{\partial z}\delta z$$
则可以得到：
$$(n_{1}\cos \alpha_{1}-n_{2}\cos \alpha_{2}+\frac{\partial\Delta S}{\partial x})\delta x+(n_{1}\cos \beta_{1}-n_{2}\cos \beta_{2}+\frac{\partial\Delta S}{\partial y})\delta y+(n_{1}\cos \gamma_{1}-n_{2}\cos \gamma_{2}+\frac{\partial\Delta S}{\partial z})\delta z=0$$
依旧将$\delta z$用$\delta x$与$\delta y$表示，带入上式则可得：

$$
\left\{
\begin{array}{l}
n_{1}\cos \alpha_{1} - n_{2}\cos \alpha_{2} + \dfrac{\partial\Delta S}{\partial x}\delta x = -pN \\
\\
n_{1}\cos \beta_{1} - n_{2}\cos \beta_{2} + \dfrac{\partial\Delta S}{\partial y}\delta y = -pN \\
\\
n_{1}\cos \gamma_{1} - n_{2}\cos \gamma_{2} + \dfrac{\partial\Delta S}{\partial z}\delta z = -pN
\end{array}
\right.
$$
最终得到折射定律的一般矢量形式，即广义斯涅尔定律
$$n_{2}\boldsymbol{A_{0}'}=n_{1}\boldsymbol{A_{0}}+p\boldsymbol{N}+grad\space\space \space \Delta S$$
$p$与面型相关。

## 2.费马原理的拉格朗日表述

::: danger
**哈密顿原理：**</br>在物理学里，哈密顿原理（英语：Hamilton's principle）是爱尔兰物理学家威廉·哈密顿于1833年发表的关于平稳作用量原理的表述。哈密顿原理阐明，一个物理系统的拉格朗日函数，所构成的泛函的变分问题解答，可以表达这物理系统的动力行为。拉格朗日函数又称为拉格朗日量，包含了这物理系统所有的物理内涵。这泛函称为作用量。哈密顿原理提供了一种新的方法来表述物理系统的运动。不同于牛顿运动定律的微分方程方法，这方法以积分方程来设定系统的作用量，在作用量平稳的要求下，使用变分法来计算整个系统的运动方程。</br> 虽然哈密顿原理本来是用来表述经典力学，这原理也可以应用于经典场，像电磁场或重力场，甚至可以延伸至量子场论等等。</br>
哈密顿原理阐明，一个物理系统的拉格朗日函数$L$所构成的作用量泛函$\mathcal{S}$，其平稳值是这物理系统的真实演化。
以数学方程表示，定义作用量为
$$\mathcal{S} \stackrel{\text{def}}{=} \int_{t_{1}}^{t_{2}} L(\mathbf{q},\dot{\mathbf{q}},t) \, dt;$$
其中，$L(\mathbf{q}, \dot{\mathbf{q}}, t)$是系统的拉格朗日函数，  
广义坐标$\mathbf{q} = (q_{1}, q_{2}, \ldots, q_{N})$是时间$t$的函数，  
$t_{1}$和$t_{2}$分别为初始时间和终结时间。</br>假若，作用量的一次变分$\delta\mathcal{S} = 0$，作用量$\mathcal{S}$为平稳值，则$\mathbf{q}(t)$正确地描述这系统的真实演化。
:::

::: danger
**拉格朗日方程：**</br>
假设一个物理系统符合完整系统的要求，即所有广义坐标都互相独立，则拉格朗日方程成立：
$$\frac{d}{dt} \left( \frac{\partial \mathcal{L}}{\partial \dot{\mathbf{q}}} \right) - \frac{\partial \mathcal{L}}{\partial \mathbf{q}} = \mathbf{0}$$
其中，$\mathcal{L}(\mathbf{q},\dot{\mathbf{q}},t)$ 是拉格朗日量，  
$\mathbf{q}=(q_{1},q_{2},\ldots,q_{N})$ 是广义坐标，是时间 $t$ 的函数，  
$\dot{\mathbf{q}}=(\dot{q}_{1},\dot{q}_{2},\ldots,\dot{q}_{N})$ 是广义速度。($\dot x$表示$x$的一阶导数)
:::
### 拉格朗日表述的推导

先对路径的微分做处理：
$$\mathrm{d}s=\sqrt{(\mathrm{d}x)^{2}+(\mathrm{d}y)^{2}+(\mathrm{d}z)^{2}}=\mathrm{d}z\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}$$
则费马原理原表达形式：
$$\delta \int_{P}^{Q}n(x,y,z)ds=0$$
可改写为：
$$\delta \int_{P}^{Q}n(x,y,z)\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}\space\mathrm{d}z=0$$
对比哈密顿原理，可定义出光学拉格朗日量：
$$L(x,y,\frac{\mathrm{d}x}{\mathrm{d}z},\frac{\mathrm{d}y}{\mathrm{d}z},z)=n(x,y,z)\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}$$
仿照经典力学可以得到光学上的拉格朗日方程式：
$$\frac{\mathrm{d}}{\mathrm{d}z}(\frac{\partial L}{\partial \dot{x}})=\frac{\partial L}{\partial x}$$
$$\frac{\mathrm{d}}{\mathrm{d}z}(\frac{\partial L}{\partial \dot{y}})=\frac{\partial L}{\partial y}$$
选择$z$轴作为光轴的正方向，将拉格朗日量代入可得：
$$\frac{\mathrm{d}}{\mathrm{d}z}\bigg[\frac{n\dot{x}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\bigg]=\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}\space\frac{\partial n}{\partial x}$$
即：
$$\frac{1}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\frac{\mathrm{d}}{\mathrm{d}z}\bigg[\frac{n\dot{x}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\bigg]=\frac{\partial n}{\partial x}$$
将$\mathrm{d}s$表达式代入可得：
$$\frac{\mathrm{d}}{\mathrm{d}s}(n\frac{\mathrm{d}x}{\mathrm{d}s})=\frac{\partial n}{\partial s}$$
$$\frac{\mathrm{d}}{\mathrm{d}s}(n\frac{\mathrm{d}x}{\mathrm{d}s})=\frac{\partial n}{\partial s}$$
$$\frac{\mathrm{d}}{\mathrm{d}s}(n\frac{\mathrm{d}x}{\mathrm{d}s})=\frac{\partial n}{\partial s}$$
融合上述三式可得：
$$\frac{\mathrm{d}}{\mathrm{d}s}\bigg(n\frac{\mathrm{d}\boldsymbol{r}}{\mathrm{d}s}\bigg)=\nabla n$$
$\boldsymbol{r}$是光线上任意点的矢量位置
::: tip
若为近轴光线，则$\mathrm{d}s\approx\mathrm{d}z$，可得近轴光线方程
$$\frac{\mathrm{d}}{\mathrm{d}z}\bigg(n\frac{\mathrm{d}\boldsymbol{r}}{\mathrm{d}z}\bigg)=\nabla n$$
:::
### 光线方程几个例题

::: info
**利用光线方程式证明：均匀介质中的光线是直线。**  
::: 
利用光线方程：
$$\frac{d}{ds}(n\frac{dr}{ds})=\nabla n $$  
$$\because n=const $$  
$$\therefore \nabla n=0$$
$$\therefore n\frac{d^{2}r}{ds^{2}}=0$$
其解为$r=as+b$  

::: info
**求自聚焦光纤中近轴光线的一般路径。**  </br>一种自聚焦光纤中的折射率方程：  
$$ n^{2}(x,y,z)=n_{0}^{2}[1-\alpha^{2}(x^{2}+y^{2})] $$  
$n_{0}$，$\alpha$为常数
::: 

由近轴光线方程式：
$$\frac{\mathrm{d}}{\mathrm{d}z}(n\frac{\mathrm{d}r}{\mathrm{d}z})=\nabla n $$  
考虑$n$与$z$无关，方程式的$x$分量为：
$$\frac{\mathrm{d}}{\mathrm{d}z}(n\frac{\mathrm{d}x}{\mathrm{d}z})=n\frac{\mathrm{d}^{2}x}{\mathrm{d}z^{2}}=\frac{\partial n}{\partial x} $$  
于是，
$$\frac{\mathrm{d}^{2}x}{\mathrm{d}z^{2}}=\frac{1}{n}\frac{\partial n}{\partial x}=\frac{1}{2n^{2}}(-2\alpha^{2}n_{0}^{2}x)\approx-\alpha^{2}x $$  
$$\therefore x(z)=A\cos(\alpha z)+B\sin(\alpha z)$$  
**$A$, $B$, $C$, $D$是决定于光线初始条件的常数**  

同理，
$$y(z)=C\cos(\alpha z)+D\sin(\alpha z)$$
考虑介质的旋转对称性，总可以将入射点选在x轴上，有$y(z=0)=0$  
$$\therefore C=0$$  

考虑入射点 $(x_0,0,0)$ 与z轴夹角为 $\gamma_0$ 的光线有：  
$$x_{z=0}=A=x_0$$  
$$\frac{}{}$$
$$\left. \dfrac{\mathrm{d}x}{\mathrm{d}z} \right|_{z=0} = -A\alpha \cdot 0 + B\alpha = B\alpha = \dfrac{\cos\alpha_x}{\cos\gamma_0}$$  
$$\therefore B = \dfrac{\cos\alpha_x}{\alpha \cos\gamma_0}$$  
同理，
$$D = \dfrac{\cos\beta_y}{\alpha \cos\gamma_0} $$  

## 3.费马原理的第三种表述-哈密顿表述

::: tip
哈密顿表述便于求理想光路，也便于计算各种像差。
::: 
### 光学广义动量（光学方向余弦）

光学拉格朗日量
$$L(x,y,\frac{\mathrm{d}x}{\mathrm{d}z},\frac{\mathrm{d}y}{\mathrm{d}z},z)=n(x,y,z)\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}$$
由于求导阶数较多，故改写为$\dot{x}$形式
$$L(x,y,\dot{x},\dot{y},z)=n(x,y,z)\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}$$
记：
$$p=\frac{\partial L}{\partial \dot{x}}=\frac{n(x,y,z)\cdot 2\dot{x}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n\frac{\mathrm{d}x}{\mathrm{d}z}}{\frac{\mathrm{d}s}{\mathrm{d}z}}=n\space \frac{\mathrm{d}x}{\mathrm{d}s}$$
$$q=\frac{\partial L}{\partial \dot{y}}=\frac{n(x,y,z)\cdot 2\dot{y}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n\frac{\mathrm{d}y}{\mathrm{d}z}}{\frac{\mathrm{d}s}{\mathrm{d}z}}=n\space \frac{\mathrm{d}y}{\mathrm{d}s}$$
**$p$、$q$分别为折射率乘以各个方向余弦，称为光学方向余弦**

### 光学哈密顿量

::: warning
 $$\frac{\mathrm d}{\mathrm{d}z}\bigg(\frac{\partial L}{\partial \dot{x}}\bigg)=\frac{\partial L}{\partial x}$$
 该公式的推导：</br>
 作用量积分：$S=\int_{z_{1}}^{z_{2}} L(x,y,\dot{x},\dot{y},z)dz$</br>
变分原理：$\delta S=0$</br>
变分运算：
$$\delta S=\int\left[\frac{\partial L}{\partial x} \delta x+\frac{\partial L}{\partial \dot{x}} \delta \dot{x}+\text{(y分量)}\right] dz=0$$
分部积分：
$$\int \frac{\partial L}{\partial \dot{x}} \frac{d}{d z}(\delta x) d z=\left[\frac{\partial L}{\partial \dot{x}} \delta x\right]_{z_{1}}^{z_{2}}-\int \frac{d}{d z}\left(\frac{\partial L}{\partial \dot{x}}\right) \delta x d z$$
固定端点：$\delta x|_{z_{1}}=\delta x|_{z_{2}}=0$</br>
最终得到：
$$\int\left[\frac{\partial L}{\partial x}-\frac{d}{dz}\left(\frac{\partial L}{\partial \dot{x}}\right)\right] \delta x d z=0$$
:::
**光学哈密顿量的定义式**
$$H=p\dot{x}+q \dot{y}-L(x,y,\dot{x},\dot{y},z)$$
对上式两边取全微分可得：
$$
\begin{aligned}
dH & = pd\dot{x} + \dot{x}dp + qd\dot{y} + \dot{y}dq - \left( \frac{\partial L}{\partial x}dx + \frac{\partial L}{\partial y}dy + \frac{\partial L}{\partial\dot{x}}d\dot{x} + \frac{\partial L}{\partial\dot{y}}d\dot{y} + \frac{\partial L}{\partial z}dz \right) \\
   & = \left( p - \frac{\partial L}{\partial\dot{x}} \right)d\dot{x} + \left( q - \frac{\partial L}{\partial\dot{y}} \right)d\dot{y} + \dot{x}dp + \dot{y}dq - \frac{\partial L}{\partial x}dx - \frac{\partial L}{\partial y}dy - \frac{\partial L}{\partial z}dz \\
   & = \dot{x}dp + \dot{y}dq - \dot{p}dx - \dot{q}dy - \frac{\partial L}{\partial z}dz
\end{aligned}
$$
根据全微分形式不变性，可见 $H$ 是 $x,y,z,p,q$ 的函数，且有：

$$
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial H}{\partial p} &= \dot{x} \\
\frac{\partial H}{\partial q} &= \dot{y} \\
\frac{\partial H}{\partial x} &= -\dot{p} \\
\frac{\partial H}{\partial y} &= -\dot{q} \\
\frac{\partial H}{\partial z} &= -\frac{\partial L}{\partial z}
\end{aligned}
\end{array}
\right.
$$
根据光学哈密顿量的定义，
$$H=p\dot{x}+q\dot{y}-L(x,y,\dot{x},\dot{y},z)$$
将利用全微分形式不变性得到的结果代入,并结合光学广义动量、光学拉格朗日量计算式：
$$p=\frac{\partial L}{\partial \dot{x}}=\frac{n(x,y,z)\cdot 2\dot{x}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n(x,y,z)\cdot \dot{x}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}$$
$$q=\frac{\partial L}{\partial \dot{y}}=\frac{n(x,y,z)\cdot 2\dot{y}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n(x,y,z)\cdot \dot{y}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}$$
$$L(x,y,\dot{x},\dot{y},z)=n(x,y,z)\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}$$
即可得到：
$$H=\frac{n\cdot \dot{x}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\cdot \dot{x}+\frac{n\cdot \dot{y}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\cdot \dot{y}-n\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}=-\frac{n}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}$$
又因为，
$$ \sqrt{n^{2} - p^{2} - q^{2}} = \left[ n^{2} - \frac{n^{2} \dot{x}^{2}}{1 + \dot{x}^{2} + \dot{y}^{2}} - \frac{n^{2} \dot{y}^{2}}{1 + \dot{x}^{2} + \dot{y}^{2}} \right]^{\frac{1}{2}} = \frac{n}{\sqrt{1 + \dot{x}^{2} + \dot{y}^{2}}} $$
故而，
$$H=-\sqrt{n^{2} - p^{2} - q^{2}}$$

>$$\sqrt{n^{2} - p^{2} - q^{2}}=\sqrt{n^{2}-n^{2}\bigg((\frac{\mathrm{d}x}{\mathrm{d}s})^{2}+(\frac{\mathrm{d}y}{\mathrm{d}s})^{2}\bigg)}=n\cos \gamma$$

## 4.高斯光学

### 高斯光学中的哈密顿量

::: info
**本节主要利用哈密顿方程式研究旋转对称光学系统中的高斯光学**

**高斯光学是什么？** 

哈密顿方程式最低阶的近似解，也叫**近轴光学**，本节研究的就是**近似的条件**以及**为什么要近似**

**旋转对称光学系统是什么？** 

即共轴光学系统
::: 

 考虑到研究对象是旋转对称光学系统（z是光轴），因此不失一般性地有：
 $$n\sim x^{2}+y^{2}$$
 结合哈密顿量可得：
 $$H=-\sqrt{n^{2}-p^{2}-q^{2}}=-\sqrt{n^{2}(u,z)-v^{2}}$$
 其中，
 $$
\left\{
\begin{array}{l}
\begin{aligned}
u=x^{2}+y^{2} \\
v=p^{2}+q^{2}
\end{aligned}
\end{array}
\right.
$$
由于研究的是近轴光学，那么则有
$$x\approx 0,y\approx0,p=n\frac{\mathrm{d}x}{\mathrm{d}s}=n\cos \alpha \approx 0,q=n\frac{\mathrm{d}y}{\mathrm{d}s}=n\cos \beta \approx 0$$
则有
$$u\approx 0,v\approx 0$$
故而哈密顿量
$$H(u,v,z)\approx H(0,0,z)$$
故可将$H(u,v,z)$在$u=0,v=0$处进行泰勒展开。

::: warning
**一元函数**在点 $x_{k}$ 处的泰勒展开式为：
$$ f(x)=f\left(x_{k}\right)+\left(x-x_{k}\right) f^{\prime}\left(x_{k}\right)+\frac{1}{2!}\left(x-x_{k}\right)^{2} f^{\prime\prime}\left(x_{k}\right)+o^{n} $$
**二元函数**在点 $(x_{k},y_{k})$ 处的泰勒展开式为：
$$
\begin{aligned}
f(x,y) &= f\left(x_{k},y_{k}\right)+\left(x-x_{k}\right)f_{x}^{\prime}\left(x_{k},y_{k}\right)+\left(y-y_{k}\right)f_{y}^{\prime}\left(x_{k},y_{k}\right) \\
& \quad + \frac{1}{2!}\left[\left(x-x_{k}\right)^{2} f_{xx}^{\prime\prime}\left(x_{k},y_{k}\right) + 2\left(x-x_{k}\right)\left(y-y_{k}\right)f_{xy}^{\prime\prime}\left(x_{k},y_{k}\right)\right. \\
& \quad \left. + \left(y-y_{k}\right)^{2} f_{yy}^{\prime\prime}\left(x_{k},y_{k}\right)\right] + o^{n}
\end{aligned}$$
**多元函数**（$n$元）在点 $x_{k}$ 处的泰勒展开式为：
$$
\begin{aligned}
f(x^{1},x^{2},\ldots,x^{n}) &= f\left(x_{k}^{1},x_{k}^{2},\ldots,x_{k}^{n}\right) \\
& \quad + \sum_{i=1}^{n}\left(x^{i}-x_{k}^{i}\right)\frac{\partial f}{\partial x^{i}}\left(x_{k}^{1},x_{k}^{2},\ldots,x_{k}^{n}\right) \\
& \quad + \frac{1}{2!}\sum_{i=1}^{n}\sum_{j=1}^{n}\left(x^{i}-x_{k}^{i}\right)\left(x^{j}-x_{k}^{j}\right)\frac{\partial^{2}f}{\partial x^{i}\partial x^{j}}\left(x_{k}^{1},x_{k}^{2},\ldots,x_{k}^{n}\right) \\
& \quad + o^{n}
\end{aligned}
$$
::: 
$$
\begin{aligned}
H(u,v,z)&=H_{0}(z)+\frac{\partial H}{\partial u}\bigg|_{u=v=0}u+\frac{\partial H}{\partial v}\bigg|_{u=v=0}v+\dots\\
\space\\
&=H_{0}(z)+H_{1}(z)+H_{2}(z)+\dots
\end{aligned}
$$
由于旋转对称性，可以先研究关于$x$与$p$的方程，同理可得$y$与$q$的方程。
$$
\because
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial u}{\partial x}=2x\\
\frac{\partial v}{\partial p}=2p
\end{aligned}
\end{array}
\right.
$$

$$
\therefore
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial }{\partial x}=2x\frac{\partial}{\partial u}\\
\space \\
\frac{\partial }{\partial p}=2p\frac{\partial}{\partial p}
\end{aligned}
\end{array}
\right.
$$
由前一节的哈密顿方程得到的结论：
$$
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial H}{\partial p} &= \dot{x} \\
\frac{\partial H}{\partial q} &= \dot{y} \\
\frac{\partial H}{\partial x} &= -\dot{p} \\
\frac{\partial H}{\partial y} &= -\dot{q} \\
\frac{\partial H}{\partial z} &= -\frac{\partial L}{\partial z}
\end{aligned}
\end{array}
\right.
$$
则可得到：
$$\dot{x}=\frac{\partial H}{\partial p}=2p\frac{\partial H}{\partial v}=2pH_{2}$$
$$\dot{p}=-\frac{\partial H}{\partial x}=-2x\frac{\partial H}{\partial u}=-2xH_{1}$$
$$\because H=-\sqrt{n^{2}(u,z)-v}$$
$$
\begin{array}{l}
\begin{aligned}
\therefore &H_{1}(z)=\frac{\partial H}{\partial u}\bigg|_{u=v=0}=-\frac{\partial n}{\partial u}\bigg|_{u=v=0}\\
\space \\
&H_{2}(z)=\dfrac{\partial H}{\partial v}\bigg|_{u=v=0} = \dfrac{1}{2\sqrt{n^{2}(u,z) - v}}\bigg|_{u=v=0}=\frac{1}{2n(0,z)}
 \end{aligned}
\end{array}$$

### 利用哈密顿量对近轴光线进行光路追迹

>**单个折射球面**

![示意图](https://picui.cn/thumbnails/8189c3820dd8300b1b0a7306cf55ec56.png))

::: tip
**球面方程也有近似** </br>
先给出球面方程，球心位于$C$点，半径为$R$:
$$x^{2}+y^{2}+(z-R)^{2}=R^{2}$$
即：</br>
$$x^{2}+y^{2}=z(2R-Z)$$
整理可得：
$$z=R\bigg[1\pm\Big(1-\frac{u}{R^{2}}\Big)^{\frac{1}{2}}\bigg]$$
考虑到当$x=y=0$时，$z=0$，故有：
$$z=R\bigg[1-\Big(1-\frac{u}{R^{2}}\Big)^{\frac{1}{2}}\bigg]$$
在$u=0$处对球面进行级数展开可得：
$$z\approx \frac{u}{2R}+\frac{u^{2}}{8R}+\dots=f(u)$$
::: 
先研究问题中的折射率分布，可由下式表示：
$$n(x,y,z)=n_{1}\Theta\bigg(f(u)-z\bigg)+n_{2}\Theta\bigg(z-f(u)\bigg)$$
其中，$\Theta(m)$表达式如下：
$$
\Theta(m)=
\left\{
\begin{array}{l}
\begin{aligned}
&1,\space m>0
\space \\
&0,\space m<0
\end{aligned}
\end{array}
\right.
$$
由推导出的$H_{1}$、$H_{2}$计算公式可得：
$$H_{1}=-\frac{\partial n}{\partial u}\bigg|_{u=v=0}=\bigg[-n_{1}\frac{\mathrm{d}\Theta}{\mathrm{d}[f(u)-z]} \cdot \frac{\mathrm{d}f(u)}{\mathrm{d}u}+n_{2}\frac{\mathrm{d}\Theta}{d[z-f(u)]}\cdot \frac{\mathrm{d}f(u)}{\mathrm{d}u}\bigg]\bigg|_{u=0} $$
$$\because z\approx \frac{u}{2R}+\frac{u^{2}}{8R}+\dots=f(u)$$
（这里只保留一次项）
$$\therefore \frac{\mathrm{d}\Theta(m)}{\mathrm{d}m}=\delta(m),\frac{\mathrm{d}f(u)}{\mathrm{d}u}=\frac{1}{2R}$$

$$\therefore H_{1}=\frac{n_{2}-n_{1}}{2R}\delta(z)$$
$$\therefore \dot{p}=-2xH_{1}=-\frac{n_{2}-n_{1}}{R}\delta(z)x$$
由上式可见，$\dot{p}=\frac{\partial L}{\partial \dot{x}}=0$，**说明光线斜率无变化，即同种介质中光线是直线。**
在$z=0$处积分，则有：
$$\int_{-\epsilon}^{\epsilon}\dot{p}dz=\int_{-\epsilon}^{\epsilon}-\frac{n_{2}-n_{1}}{R}\delta(z)xdz$$
可得：
$$p_{2}-p_{1}=-\frac{n_{2}-n_{1}}{R}x_{0}$$
在介质中，近轴条件下有：
$$p_{1}=n_{1}\frac{\mathrm{d}x}{\mathrm{d}z},p_{2}=n_{2}\frac{\mathrm{d}x}{\mathrm{d}z}$$
观察图像可得：
$$p_{1}=n_{1}\frac{x_{0}}{z_{0}-z_{1}}=-n_{1}\frac{x_{0}}{z_{1}}$$
$$p_{2}=n_{2}\frac{-x_{0}}{z_{2}-z_{1}}=-n_{2}\frac{x_{0}}{z_{2}}$$
$$\therefore \frac{n_{2}}{z_{2}}-\frac{n_{1}}{z_{1}}=\frac{n_{2}-n_{1}}{R}$$
第一焦距，物方焦距：
$$z_{2}\rightarrow \infty,z_{1}=-\frac{nR}{n_{2}-n_{1}}$$
第二焦距，像方焦距：
$$z_{1}\rightarrow \infty,z_{2}=\frac{n_{2}R}{n_{2}-n_{1}}$$
> **对应应用光学中的公式：**
>
> $$\frac{n_{2}}{f'}-\frac{n_{1}}{f}=\frac{n_{2}-n_{1}}{R}$$

> **薄透镜**
>
> 两折射面之间的距离可以忽略的透镜，第一面上的光线高度等于第二面上的光线高度

![示意图](https://picui.cn/thumbnails/aa206c7b99b1616d77f3eb75927446c7.png)

和单个折射球面相比，只是引入了透镜介质，相当于多了一个中间量
$$p_{1}-p_{0}=-\frac{n_{1}-n_{0}}{R_{1}}x_{0}$$
$$p_{2}-p_{1}=-\frac{n_{2}-n_{1}}{R_{2}}x_{0}$$
$$\therefore p_{2}-p_{0}=\bigg(\frac{n_{1}-n_{2}}{R_{2}}-\frac{n_{1}-n_{0}}{R_{1}}\bigg)x_{0}$$
$$\because p_{0}=-n_{0}\frac{x_{0}}{z_{0}},p_{2}=-n_{2}\frac{x_{0}}{z_{2}}$$
$$\therefore \frac{n_{0}}{z_{0}}-\frac{n_{2}}{z_{2}}=\frac{n_{1}-n_{2}}{R_{2}}-\frac{n_{1}-n_{0}}{R_{1}}$$

## 5.本章小节
>**1.费马原理的第一种表述-极端光程定律** </br>
>连接给定点$P$和$Q$有许多路径，而光线只沿着光程为极值的路径进行传播，即：
>$$\delta \int_{P}^{Q}n(x,y,z)ds=0$$
>极值也有三种情况，极大值、极小值、稳定值。

>**2.费马原理的第二种表述-拉格朗日表述**
>$$\delta \int_{P}^{Q}n(x,y,z)\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}\space\mathrm{d}z=0$$
>对比哈密顿原理，可定义出光学拉格朗日量：
>$$L(x,y,\frac{\mathrm{d}x}{\mathrm{d}z},\frac{\mathrm{d}y}{\mathrm{d}z},z)=n(x,y,z)\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}$$

>**3.费马原理的第三种表述-哈密顿表述**
>
>**光学拉格朗日量**
>$$L(x,y,\frac{\mathrm{d}x}{\mathrm{d}z},\frac{\mathrm{d}y}{\mathrm{d}z},z)=n(x,y,z)\sqrt{1+(\frac{\mathrm{d}x}{\mathrm{d}z})^{2}+\frac{\mathrm{d}y}{\mathrm{d}z})^{2}}$$
>由于求导阶数较多，故改写为$\dot{x}$形式
>$$L(x,y,\dot{x},\dot{y},z)=n(x,y,z)\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}$$
>记：
>$$p=\frac{\partial L}{\partial \dot{x}}=\frac{n(x,y,z)\cdot 2\dot{x}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n\frac{\mathrm{d}x}{\mathrm{d}z}}{\frac{\mathrm{d}s}{\mathrm{d}z}}=n\space \frac{\mathrm{d}x}{\mathrm{d}s}$$
>$$q=\frac{\partial L}{\partial \dot{y}}=\frac{n(x,y,z)\cdot 2\dot{y}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n\frac{\mathrm{d}y}{\mathrm{d}z}}{\frac{\mathrm{d}s}{\mathrm{d}z}}=n\space \frac{\mathrm{d}y}{\mathrm{d}s}$$
>**$p$、$q$分别为折射率乘以各个方向余弦，称为光学方向余弦**
>$$H=p\dot{x}+q \dot{y}-L(x,y,\dot{x},\dot{y},z)$$
>对上式两边取全微分可得：
>$$
>\begin{aligned}
dH & = pd\dot{x} + \dot{x}dp + qd\dot{y} + \dot{y}dq - \left( \frac{\partial L}{\partial x}dx + \frac{\partial L}{\partial y}dy + \frac{\partial L}{\partial\dot{x}}d\dot{x} + \frac{\partial L}{\partial\dot{y}}d\dot{y} + \frac{\partial L}{\partial z}dz \right) \\
   & = \left( p - \frac{\partial L}{\partial\dot{x}} \right)d\dot{x} + \left( q - \frac{\partial L}{\partial\dot{y}} \right)d\dot{y} + \dot{x}dp + \dot{y}dq - \frac{\partial L}{\partial x}dx - \frac{\partial L}{\partial y}dy - \frac{\partial L}{\partial z}dz \\
   & = \dot{x}dp + \dot{y}dq - \dot{p}dx - \dot{q}dy - \frac{\partial L}{\partial z}dz
\end{aligned}
>$$
>根据全微分形式不变性，可见 $H$ 是 $x,y,z,p,q$ 的函数，且有：
>$$
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial H}{\partial p} &= \dot{x} \\
\frac{\partial H}{\partial q} &= \dot{y} \\
\frac{\partial H}{\partial x} &= -\dot{p} \\
\frac{\partial H}{\partial y} &= -\dot{q} \\
\frac{\partial H}{\partial z} &= -\frac{\partial L}{\partial z}
\end{aligned}
\end{array}
\right.
>$$
>根据光学哈密顿量的定义，
>$$H=p\dot{x}+q\dot{y}-L(x,y,\dot{x},\dot{y},z)$$
>将利用全微分形式不变性得到的结果代入,并结合光学广义动量、光学拉格朗日量计算式：
>$$p=\frac{\partial L}{\partial \dot{x}}=\frac{n(x,y,z)\cdot 2\dot{x}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n(x,y,z)\cdot \dot{x}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}$$
>$$q=\frac{\partial L}{\partial \dot{y}}=\frac{n(x,y,z)\cdot 2\dot{y}}{2\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}=\frac{n(x,y,z)\cdot \dot{y}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}$$
>$$L(x,y,\dot{x},\dot{y},z)=n(x,y,z)\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}$$
>即可得到：
>$$H=\frac{n\cdot \dot{x}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\cdot \dot{x}+\frac{n\cdot \dot{y}}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}\cdot \dot{y}-n\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}=-\frac{n}{\sqrt{1+\dot{x}^{2}+\dot{y}^{2}}}$$
>又因为，
>$$ \sqrt{n^{2} - p^{2} - q^{2}} = \left[ n^{2} - \frac{n^{2} \dot{x}^{2}}{1 + \dot{x}^{2} + \dot{y}^{2}} - \frac{n^{2} \dot{y}^{2}}{1 + \dot{x}^{2} + \dot{y}^{2}} \right]^{\frac{1}{2}} = \frac{n}{\sqrt{1 + \dot{x}^{2} + \dot{y}^{2}}} $$
>故而，
>$$H=-\sqrt{n^{2} - p^{2} - q^{2}}$$
>$$\sqrt{n^{2} - p^{2} - q^{2}}=\sqrt{n^{2}-n^{2}\bigg((\frac{\mathrm{d}x}{\mathrm{d}s})^{2}+(\frac{\mathrm{d}y}{\mathrm{d}s})^{2}\bigg)}=n\cos \gamma$$
>
