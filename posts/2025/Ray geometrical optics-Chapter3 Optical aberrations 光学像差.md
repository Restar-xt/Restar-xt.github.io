---
title: Ray geometrical optics-Chapter3 Optical aberrations 光学像差
tags: [Zemax]
categories: [光设理论基础]
date: 2025-9-22
description: 本笔记参考 《Optical imaging and aberrations part I. Ray geometrical optics》
articleGPT: 这是Optical imaging and aberrations part I. Ray geometrical optics中第三章Optical aberrations的相关笔记，本章从波像差和几何像差的定义入手，点明波像差与几何像差之间的关系，明确从波像差中可以推导出几何像差这一重要结论。在此基础上，引入离焦波像差和波前倾斜两类因为观察角度或元件装配等问题产生的波像差。进一步地，讨论了关于其光轴旋转对称的成像系统可能存在的像差。将系统像差函数展开为物坐标与瞳坐标的幂级数，引入初级、二级、三级像差理论。该像差也可通过泽尼克圆（Zernike circle polynomials）多项式进行展开，并给出了两类展开系数之间的转换关系。文中简要讨论了初级像差的干涉图特征，以阐明实践中如何识别此类像差。最终通过论述系统在何种条件下可形成无像差完美成像来结束本章，重点推导了正弦条件：若满足该条件的离轴共轭点所在平面中，轴向共轭点已实现完美成像，则所有阶彗差均为零。
references:
  - title: 《Optical imaging and aberrations part I. Ray geometrical optics》
  - url: https://doi.org/10.1117/3.265735
   
---




# Ray geometrical optics-Chapter3 Optical aberrations 光学像差

> **参考书目：**  
>**$\text{Optical imaging and aberrations: part I. Ray geometrical optics}$**                &ensp;      $\text{Virendra N. Mahajan}$
>
>$\text{ISBN 0-8194-2515-X}$



## 本章概述


对特定物点而言，其**波像差表征出射光瞳处波前偏离球面的光学偏差量**。若波像差为零（即波前呈理想球面），则所有光线汇聚于曲率中心形成完美点像。系统像差将导致成像质量劣化，而**光线像差（即几何像差）则反映光线在过曲率中心的像平面上相对该中心的位移量**。

虽然**可通过全光路追迹至像平面获得特定物点的光线像差，但亦可从波像差推导获取**。需注意：**<font color='red'>像平面上的光线分布并非真实成像图景，因其未计入出射光瞳处的波前衍射效应</font>**。波像差作为决定成像质量的核心参数，其量化表征至关重要。

值得强调的是：**多元件系统的波像差具有可加性——全系统的光线波像差等于各元件波像差之和**。但**光线像差不具此性质，最终像平面上的光线像差不可通过元件像平面值简单叠加获得**。

当观测平面偏离曲率中心所在像面时，将引入**离焦波像差**；同理，系统内成像元件沿光轴位移亦会产生此效应。我们将推演像面纵向离焦量与由此引发的离焦像差之函数关系。类似地，当成像元件微倾或横向偏离光轴时，会产生**波前倾斜**现象。我们将阐明波前倾斜与其对应像差的关联机制。

其次，讨论了关于其光轴旋转对称的成像系统可能存在的像差。将系统像差函数**展开为物坐标与瞳坐标的幂级数，引入初级、二级、三级像差理论**。该像差也可通过**泽尼克圆（Zernike circle polynomials）多项式**进行展开，并给出了两类展开系数之间的转换关系。文中简要讨论了初级像差的干涉图特征，以阐明实践中如何识别此类像差。最终通过论述系统在何种条件下可形成无像差完美成像来结束本章，重点推导了正弦条件：若满足该条件的离轴共轭点所在平面中，轴向共轭点已实现完美成像，则所有阶彗差均为零。

## 波像差、光线像差的定义

[![通过光学系统实现完美成像。P为物点，P′为其对应的高斯像点。](https://free.picui.cn/free/2025/09/02/68b65eb3d8c62.png)](https://free.picui.cn/free/2025/09/02/68b65eb3d8c62.png)

### 波像差 wave aberration

> - 光程：即折射率乘光线传播路径长度
> - 波前：如果从某一个点处发出的光线经过光学系统，并追溯其至出瞳处，同时确保每条光束的实际光程均等于主光线光程（主光线即穿过出瞳中心的光线），将这些光线的等光程点连接构成的曲面即为波前。

先考虑**完善成像**。
- 从**波的角度**分析：若**出瞳处的波前为球面，且其曲率中心在高斯像点处**，我们就称该系统完善成像（波前原本是球面，经过光学系统后仍是球面；原始波前以物点为曲率中心扩散，经过系统后的波前以高斯像点为中心收敛）
- 从**光线角度**分析：通过$P$传播至$P'$的**所有光线光程都相同**，即为完善成像。

完善成像时出瞳位置处的波前为球面，我们称之为高斯参考球面（Gaussian reference sphere）如果，
- 从**波的角度**分析：实际波前偏离高斯参考球面，则称该系统成像有像差。
- 从**光线角度**分析：通过$P$传播至$P'$的光线光程不都相同，则称该系统成像有像差。

在参考球面上某点处光线的**波像差**，**等于该光线对应的波前相对于高斯球面波前的光程差**。它反映了所考察光线与主光线从**点物传播至参考球面**过程中的**光程差**。而主光线对应的波像差恒为零，加之所有理想光线从参考球面到高斯像点的光程相等，因此，**任意光线的波像差亦可表述为：该光线从点物$P$到高斯像点$P'$的光程与主光线光程之差**。更详细的表述是：实际光线从物点$P$传播到高斯参考球面$Q$点（**这一部分光线是真实的，即为实际光线的传播路径**）后，再由$Q$传播到高斯像点$P'$（**这一部分光线是虚拟的，实际光线并不会传播到高斯像点**）的光程和主光线光程之差。


### 轴上物点对应的波像差

[![轴上物点对应的波像差示意图](https://free.picui.cn/free/2025/09/03/68b7be45f0f8f.png)](https://free.picui.cn/free/2025/09/03/68b7be45f0f8f.png)

- 高斯像点-高斯参考球面曲率中心：$P_{0}'$
- 实际像点：$P_{0}''$
- 理想波前-高斯参考球面：虚线绘制，通过出瞳中心点$O$
- 实际波前：实线绘制，通过出瞳中心点$O$
- 实际光线与高斯参考球面的交点：$Q$
- 实际光线与实际波前的交点：$\overline{Q}$
- 主光线：$CR_{0}$
- 实际光线：$GR_{0}$
- 波像差：$n_{i}\overline{Q} Q$

### 轴外物点对应的波像差

[![轴外物点对应的波像差示意图](https://free.picui.cn/free/2025/09/03/68b7be45ee7d8.png)](https://free.picui.cn/free/2025/09/03/68b7be45ee7d8.png)

- 高斯像点-高斯参考球面曲率中心：$P_{0}'$
- 实际像点：$P''$
- 理想波前-高斯参考球面：虚线绘制，通过出瞳中心点$O$
- 实际波前：实线绘制，通过出瞳中心点$O$
- 实际光线与高斯参考球面的交点：$Q$
- 实际光线与实际波前的交点：$\overline{Q}$
- 主光线：未绘制
- 实际光线：$GR$
- 波像差：$n_{i}\overline{Q} Q$

### 几何像差/光线像差 geometrical aberration
以轴外物点对应的波像差示意图为例，高斯像点为$P'$，实际像点为$P''$，实际像点与高斯像点的偏移$P'P''$即为几何像差。


### 研究波像差时的坐标系建立

均为右手直角坐标系（笛卡尔坐标系）。其中光轴沿$z$轴，物体平面、出瞳平面、高斯像面均垂直于$z$轴并相互平行。
- 物平面 object：坐标原点位于$P_{0}$，物点位于$x$轴上。
- 出瞳平面 pupil：坐标原点位于$O$，$Q$为出瞳面实际波前上一点。
- 高斯像面 Gaussian image：坐标原点位于$P_{0}$，高斯像点为$P'(x_{g},0,z_{g})$，实际像点为$P''(x_{i},y_{i},z_{g})$
  
将轴外物点位置假设在$x$轴上虽然很特殊，但是**考虑系统的旋转对称性**，这样特殊假设得出的结论是具有一般性的。

[![坐标系](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)

### 波像差与几何像差对比

| 对比维度         | 波像差 (Wavefront Aberration)                          | 几何像差 (Geometrical Aberration)                       |
|------------------|--------------------------------------------------------|-------------------------------------------------------|
| 定义             | 实际波前与理想球面波前的偏差                           | 光线经光学系统后实际像点与理想像点的偏离                      |
| 理论基础         | 基于波动光学理论                                       | 基于几何光学理论                                      |
| 描述对象         | 描述波前的畸变                                         | 描述光线的传播误差                                    |
| 数学表达         | 通常用**多项式**（如泽尼克多项式）表示                     | 用**赛德尔像差（球差、彗差、像散等）分类**描述            |
| 分析视角         | 相位分布视角                                           | 光线追迹视角                                          |
| 像质评价联系     | 与斯特列尔比（Strehl Ratio）和调制传递函数（MTF）直接相关 | 与点列图、光线扇图直接相关                            |
| 优点             | 更接近光的本质，能精确描述衍射效应                     | 直观易懂，计算相对简单                                |
| 局限性           | 计算复杂，对高数值孔径或大像差系统分析困难             | 忽略衍射效应，在接近衍射极限的系统中准确性下降        |
| 多元件叠加性           | 可以直接叠加得到系统总波像差             | 无法直接相加        |

**几何像差直观易算，能够用数值来描述一点成像时的几何光线的密集程度，从而评估像质的优劣。但光线本身是一抽象的近似概念，用密集程度来评价，往往与实际不符，因此必须考虑像差的最佳校正方案，并根据光学系统的要求和使用状况给出合理像差。而这些像质评价问题常须基于光的波动本质才能解决。此外，波像差可以推导出几何像差。**

## 哈密顿点特征函数 Hamilton’s Point Characteristic Function

[![在具有折射率  $n'$  的介质中，单位矢量为  $\hat{u}'$  的光线传播路径。波阵面  $W'$  和  $W''$  分别通过该光路上两点  $P'$  和  $A$ ](https://free.picui.cn/free/2025/09/03/68b85629e1880.png)](https://free.picui.cn/free/2025/09/03/68b85629e1880.png)

若考虑折射率分别为  $n$  和  $n'$  的两种介质中的点  $P$  和  $P'$ ，其三维位置矢量分别为  $\mathbf{r}$  和  $\mathbf{r}'$ ，则从  $P$  到  $P'$  的光线光程长度称为**哈密顿点特征函数**，可表示为  $V(P, P')$  或  $V(\mathbf{r}, \mathbf{r}')$ 。

令  $\mathbf{\hat{u}}'$  为过  $P'$  的射线方向的单位矢量，**显然物点$P$应该在该光线上的反向延长线上，即$P$与$P'$共线**。如上图所示，考察邻近点  $P''$ ，其位置矢量为  $\mathbf{r}' + \delta\mathbf{r}'$ （此处  $\delta\mathbf{r}'$  表示从  $P'$  指向  $P''$  的矢量  $\overrightarrow{P'P''}$ ）。沿光线路径  $PBP''$（仍为一条直线）  的点特征函数可写作  $V(\mathbf{r}, \mathbf{r}' + \delta\mathbf{r}')$ 。若将  $V$  视为  $\mathbf{r}'$  的函数，则可表示为:

$$V(\mathbf{r},\mathbf{r'}+\delta{\mathbf{r'}})-V(\mathbf{r},\mathbf{r'})=\delta\mathbf{r'}\cdot \nabla'V$$

其中，$\nabla'$是关于$\mathbf{r'}$的梯度算子。

- **对于公式左侧**：考虑波前的定义，同一波前上的某点到物点的光程应相同，即:
  $$opl(PB)=opl(PP')$$
  $$opl(PBP'')=opl(PP'A)$$
  那么则有：
  $$opl(PBP'')-opl(PB)=opl(PP'A)-opl(PP')$$
  即：
  $$opl(BP'')=opl(P'A)$$
  因此
  $$\begin{aligned}
    V(\mathbf{r},\mathbf{r'}+\delta{\mathbf{r'}})-V(\mathbf{r},\mathbf{r'}) &= opl(PBP'') - opl(PP') \\
    &= opl(PP'A) - opl(PP') \\
    &= opl(P'A) \\
    &= opl(BP'')
    \end{aligned}$$

  而对于$P'A$，根据向量数量积的定义可知：
  $$\overline{P'A}=\overrightarrow{P'P''}\cdot \mathbf{\hat{u}'}=\delta\mathbf{r'}\cdot \mathbf{\hat{u}}'$$

  那么等式左侧即可写为：
  $$opl(P'A)=n'\mathbf{\hat{u}'}\cdot \delta \mathbf{r'}$$

- **对于公式右侧**：不需要进一步整理。
  
综上所述，即可得到：
$$\boxed{n'\mathbf{\hat{u}'}\cdot \delta \mathbf{r'}=\delta\mathbf{r'}\cdot \nabla'V}$$

化简即可得到：

$$\boxed{n'\mathbf{\hat{u}'}= \nabla'V}$$

上述公式的物理意义：**终点$P'$处的光线方向$\mathbf{\hat{u}'}$由哈密顿点特征函数对终点位置的梯度决定**。

## 波像差和几何像差关系推导

[![轴上物点对应的波像差示意图](https://free.picui.cn/free/2025/09/03/68b7be45f0f8f.png)](https://free.picui.cn/free/2025/09/03/68b7be45f0f8f.png)

[![轴外物点对应的波像差示意图](https://free.picui.cn/free/2025/09/03/68b7be45ee7d8.png)](https://free.picui.cn/free/2025/09/03/68b7be45ee7d8.png)


在上面两个图中，以实际光线$GR_{0}$或$GR$为例，该光线分别与波前及参考球面相交于点$\overline{Q}$和点$Q$。根据波前的定义，从物点出发终止于$\overline{Q}$的光线，其光程与终止于$O$点的主光线光程相等。因此，$n_{i}\overline{Q}Q$表征了所研究光线的波像差（如图所示，其数值为正）。设$W(x,y)$代表该波像差，其中$(x,y,z)$为点Q的空间坐标。由于点$Q$位于参考球面上，**其$z$坐标与$x$、$y$呈函数关系**，故无需显式考虑$W$对$z$的依存性。

> **波像差的正负问题：**
>
> - 从光程角度入手：
>   若实际光线传播到高斯参考球面的光程大于主光线传播到高斯参考球面的光程，则波像差为正，反之则否。
> - 从几何上直观来看：
>   若实际波前位于高斯参考球面（理想波前）左侧，波像差为正，反之则否。

对于上图中的实际光线$GR_{0}$与$GR$对应的波像差，可以用哈密顿点特征函数表示：

$$W(x,y)=V(P,Q)-V(P,\overline{Q})$$
又因为，
$$V(P,\overline{Q})=V(P,O)$$
所以有：
$$W(x,y)=V(P,Q)-V(P,O)$$
上式对$x$求偏导可得：
$$\frac{\partial W}{\partial x}=\frac{\partial V(P,Q)}{\partial x}-0=\frac{\partial V(P,Q)}{\partial x}$$
考虑到，$z$是关于$x$,$y$的函数，那么上式可写为：
$$\frac{\partial W}{\partial x}=\frac{\partial V}{\partial x}+\frac{\partial V}{\partial z}\frac{\partial z}{\partial x}$$

[![坐标系](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)

利用公式：
$$\boxed{n'\mathbf{\hat{u}'}= \nabla'V}$$
考虑其物理意义：**终点$P'$处的光线方向$\mathbf{\hat{u}'}$由哈密顿点特征函数对终点位置的梯度决定**。

将该公式应用至$QP''$段，则有：
$$\bigg(\frac{\partial V}{\partial x},\frac{\partial V}{\partial y},\frac{\partial V}{\partial z}\bigg)=\frac{n_{i}}{R'}(x_{i}-x,y_{i}-y,z_{g}-z)$$
其中，$R'$为$QP''$长度，$n_{i}$为其所在空间中的折射率。

而，
$$QP'=OP'=R$$
则有：
$$x_{g}^{2}+z_{g}^{2}=R^{2}$$
$$(x-x_{g})^{2}+y^{2}+(z-z_{g})^{2}=R^{2}$$
即：
$$x_{g}^{2}+z_{g}^{2}=(x-x_{g})^{2}+y^{2}+(z-z_{g})^{2}$$
化简可得：
$$x^{2}+y^{2}+z^{2}-2xx_{g}-2zz_{g}=0$$
上式对$x$求偏导即可得到：
$$2x+2z\frac{\partial z}{\partial x}-2x_{g}-2z_{g}\frac{\partial z}{\partial x}=0$$
即：
$$\frac{\partial z}{\partial x}=-\frac{x-x_{g}}{z-z_{g}}$$

综上，得到三个等式：
$$\begin{cases}
\dfrac{\partial W}{\partial x}=\dfrac{\partial V}{\partial x}+\dfrac{\partial V}{\partial z}\dfrac{\partial z}{\partial x}\\ 
\space \\  
\left( \dfrac{\partial V}{\partial x}, \dfrac{\partial V}{\partial y}, \dfrac{\partial V}{\partial z} \right) = \dfrac{n_{i}}{R'} \left( x_{i} - x, y_{i} - y, z_{g} - z \right) \\
\space \\
\dfrac{\partial z}{\partial x} = -\dfrac{x - x_{g}}{z - z_{g}}

\end{cases}$$

三式结合，最终可以得到:


$$
\begin{aligned}
\frac{\partial W}{\partial x} &= \frac{n_{i}}{R'}(x_{i}-x) - \frac{n_{i}}{R'}(z_{g}-z) \cdot \frac{x - x_{g}}{z - z_{g}} \\
&= \frac{n_{i}}{R'}(x_{i}-x_{g})
\end{aligned}
$$

可改写为：
$$\boxed{x_{i}-x_{g}=\frac{R'}{n_{i}}\frac{\partial W}{\partial x}}$$

同理：
$$\boxed{y_{i}=\frac{R'}{n_{i}}\frac{\partial W}{\partial y}}$$

上述二式给出了参考球面上点$(x, y, z)$处的波像差 $W(x, y)$ 与高斯像平面中光线像差 $(x_i-x_g,y_i)$ 之间的精确关系。然而，这两个公式所含的距离 $R'$ 本身取决于点P′′的坐标 $(x_i, y_i)$ 。


由于实际参考球面的曲率半径 $R$ 远大于光线分布范围，可将 $R'$ 替换为 $R$ ，并表述为：

$$
\begin{cases}
\boxed{x_{i}=\frac{R}{n_{i}}\frac{\partial W}{\partial x}} \\
\space \\
\boxed{y_{i}=\frac{R}{n_{i}}\frac{\partial W}{\partial y}}
\end{cases}
$$
即：
$$\boxed{(x_{i},y_{i})=\frac{R}{n_{i}}\bigg(\frac{\partial W}{\partial x},\frac{\partial W}{\partial{y}}\bigg)}$$

此处 $x_i$、$y_i$ 表示点$P''$相对于高斯像点$P'$的坐标参数。在窄视场系统中，$P'$邻近于$P_{0}'$，此时可用 $z_g$ 替代 $R$。需强调：当物点为轴上点时，恒有 $R = z_g$ 。

综上所述可得结论：**如果$W(x,y)$表示某个光线在出瞳处的波像差，那么这条光线的几何像差则可由其波像差的空间导数乘以高斯参考球面的曲率半径，再除以像方空间的折射率得到。**


由于光线与波前垂直，几何像差取决于波前的形状，进而取决于其相对于参考球面的几何程差。前面几个式子中除以$n_{i}$的运算将光程差转换为几何程差。

 ### **转换为极坐标系**

 考虑到之前讨论使用的均为笛卡尔直角坐标系，现在将坐标系转换为极坐标系，此时则有：
 $$(x,y)=r(\cos \theta,\sin \theta)$$
 考虑到子午光线在出瞳面处沿$x$轴分布，故对应$\theta=0/\pi$
 
考虑到弧矢光线在出瞳面沿$y$轴分布，故对应$\theta=\frac{1}{2}\pi/\frac{3}{2}\pi$

 如果$W(r,\theta)$表示极坐标下的波像差，那么对应极坐标下的几何像差应该表示为：
 $$x_i = \frac{R}{n_i} \left( \cos \theta \frac{\partial W}{\partial r} - \frac{\sin \theta}{r} \frac{\partial W}{\partial \theta} \right)$$


下面是详细的**数学推导过程**：

---

**1.从笛卡尔直角坐标系到极坐标的关系**



$$
x = r \cos \theta, \quad y = r \sin \theta
$$

因此，函数 $W(x, y)$ 可转化为 $W(r, \theta)$，也就是说：

$$
W(x, y) = W(r(x, y), \theta(x, y))
$$

我们希望将 $\frac{\partial W}{\partial x}$ 表示为 $r, \theta$ 的偏导。

---

**2.链式法则转换 $\frac{\partial W}{\partial x}$**

根据多元函数链式法则：

$$
\frac{\partial W}{\partial x} = \frac{\partial W}{\partial r} \cdot \frac{\partial r}{\partial x} + \frac{\partial W}{\partial \theta} \cdot \frac{\partial \theta}{\partial x}
$$

我们现在分别计算：

 1. $r = \sqrt{x^2 + y^2} \Rightarrow \frac{\partial r}{\partial x} = \frac{x}{\sqrt{x^2 + y^2}} = \cos \theta$

 2. $\theta = \arctan\left(\frac{y}{x}\right) \Rightarrow \frac{\partial \theta}{\partial x} = \frac{-y}{x^2 + y^2} = -\frac{\sin \theta}{r}$

（用了三角关系：$x = r \cos \theta, y = r \sin \theta$）

---

**3.代入链式法则**

将上面计算结果代入链式法则：

$$
\frac{\partial W}{\partial x} = \frac{\partial W}{\partial r} \cdot \cos \theta - \frac{\partial W}{\partial \theta} \cdot \frac{\sin \theta}{r}
$$

---

**4.代入原始像差公式**

将其代入最初的横向像差表达式：

$$
x_i = \frac{R}{n_i} \left( \cos \theta \cdot \frac{\partial W}{\partial r} - \frac{\sin \theta}{r} \cdot \frac{\partial W}{\partial \theta} \right)
$$

## 旋转对称系统的像差函数 

> 本节研究**旋转对称光学系统对点物成像**时的像差特性。此类系统的像差取决于物高$h$（或像高$h'$）与光瞳坐标$r$、$\theta$，且通过三个旋转不变量$h^{2}$、$r^{2}$与$hr·\cos\theta$表征。通过构建像差函数的幂级数展开，系统引入初级、次级及三级像差。同时采用泽尼克圆多项式对像差函数进行展开，并阐明幂级数展开系数与泽尼克多项式展开系数间的映射关系。

### 旋转不变量 Rotational Invariants

[![坐标示意图](https://free.picui.cn/free/2025/09/16/68c973da1a298.png)](https://free.picui.cn/free/2025/09/16/68c973da1a298.png)

- $(x_{o},y_{o})$：为物点对应的直角坐标，位于以$P_{o}$为坐标原点的坐标系中，设其位置矢量为$\overrightarrow{h}$，在与光轴正交的平面内（考虑到旋转对称系统，这样的假设不失一般性）

- $(x,y)$：为物点发出的光线在出瞳面上的交点对应的直角坐标，设其位置矢量为$\overrightarrow r$

- 上述两点分属两个不同的坐标系，但是$z_{o}$轴和$z$轴是重合的，即为光轴。坐标系建立参考下图。
[![坐标系](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)


该光学系统对所述物点的像差函数 在最一般形式下可表述为**关于物点与光瞳点矩形坐标的幂级数**，其表达式为：


$$W(x_{o},y_{o};x,y)=\sum\limits_{j=0}^{\infty}x_{o}^{j} \sum\limits_{k=0}^{\infty}y_{o}^{k} \sum\limits_{l=0}^{\infty}x^{l} \sum\limits_{m=0}^{\infty}y^{m} a_{jklm}$$

$a_{jklm}$为展开系数，该系数取决于系统的结构参数，如系统表面的曲率半径、它们之间空间的折射率以及它们之间的间距。注意该级数由四个直角坐标$x_{o}$，$y_{o}$， $x$，$z$的非负整数幂(包括零项)组成。

> **<font color='red'>关于该展开式形式的解释</font>**
>
> **1. 波像差函数的变量依赖**
>
> 波像差函数 $W(x_o, y_o; x, y)$ 本质上是一个 **多元函数**，它依赖于：
>
>* 物点在物面上的横向位置：$(x_o, y_o)$，
>* 出瞳上光线穿过的位置：$(x, y)$。
>
>换句话说，像差的大小取决于“物点在哪”和“光线从瞳孔的哪个点进入”。
>
>**2. 数学上的一般展开原则**
>
>在数学上，**任何解析的多元函数**，都可以在参考点（通常取在光轴附近 $x_o=0, y_o=0, x=0, y=0$）做多元泰勒展开：
>
>$$
W(x_o, y_o; x, y) = \sum_{j,k,l,m} a_{jklm} \, x_o^j \, y_o^k \, x^l \, y^m
>$$
>
>这就是“为了覆盖所有可能的依赖关系需要展开成物点坐标的幂与瞳面坐标的幂”的数学含义：
>
>* $j,k$ 负责展开物点的坐标依赖；
>* $l,m$ 负责展开瞳面坐标的依赖；
>* 乘积形式 $(x_o^j y_o^k)(x^l y^m)$ 就是多元泰勒级数的自然结果。
>
>这样我们不会遗漏任何可能的项，因为泰勒级数包含了所有阶的组合。
>
>**3. 为什么不能只用单一变量展开**
>如果只对 $(x,y)$ 展开，就只能描述 **光阑依赖的像差**，但无法体现不同物点位置（场点）带来的变化，比如像散、场曲、畸变。
>同理，如果只对 $(x_o,y_o)$ 展开，就忽略了瞳面分布，不可能得到球差、慧差等。
>
>因此，必须 **同时展开两组变量**，用它们的乘积项来全面描述。
>
> **4. 物理意义上的“覆盖所有依赖关系”**
>
>* **$x_o,y_o$ 的幂次** → 描述像差随场点（物点偏离光轴）的变化。
>* **$x,y$ 的幂次** → 描述像差随瞳孔坐标的变化。
>* **乘积项** → 描述场点和瞳面坐标的耦合效应（比如场点偏离时球差、慧差等会如何变化）。
>
>总结一句话：
“为了覆盖所有可能的依赖关系需要展开成物点坐标的幂与瞳面坐标的幂”——其实就是在说，波像差函数是一个关于两组变量 $(x_o,y_o)$ 和 $(x,y)$ 的解析函数，而**多元泰勒展开必然产生这些变量幂次的乘积项**，这样才能完整地表达像差对物点位置和瞳面坐标的全部依赖关系。
>
>**5.为什么展开式是乘积形式？**
>
> 设有一个光学像差函数：
>
>$$
W(x_o, y_o; x, y)
>$$
>
>这是一个关于四个变量的解析函数。
>
>数学上，**多元函数的泰勒展开**形式是：
>
>$$
W(x_o, y_o; x, y) = \sum_{j,k,l,m} 
\frac{1}{j!k!l!m!}
\left. \frac{\partial^{j+k+l+m} W}{\partial x_o^j \partial y_o^k \partial x^l \partial y^m}\right|_{0,0,0,0} 
x_o^j y_o^k x^l y^m
>$$
>可以看到，展开项的基本单元必然是 **变量的幂次乘积**：
>
>$$
x_o^j y_o^k x^l y^m
>$$
>
>这是多元泰勒展开的基本结构，它不是人为选择的，而是**微积分定理强制要求的形式**。
>
>假设我们只写成“加减形式”，例如：
>
>$$
W(x_o, y_o; x, y) = f(x_o,y_o) + g(x,y)
>$$
>
>这样只能表示“物点影响”和“瞳面影响”是完全独立的。
但实际物理里它们会 **耦合**：
>
>* 离轴物点（$x_o, y_o \neq 0$）时，慧差、像散等才出现；
>* 在轴上物点（$x_o=y_o=0$）时，耦合项消失，只剩下球差。
>
>所以，必须有 **乘积项**，比如：
>
>* $x_o \cdot x^2$：表示当物点偏离轴时，瞳面不同位置光线的像差才会显现。
>* $y_o^2 \cdot y^2$：表示场曲/像散效应随物点偏离和瞳面坐标同时作用。
>
>如果不用乘积项，这些物理现象完全没法刻画。

**考虑到光学系统的瞳面大部分都是圆形的，因此在研究过程中使用极坐标是非常方便的。**

- 物点直角坐标$(x_{o},y_{o})$对应的位置矢量为$\overrightarrow{h}$，对应的极坐标可写为$(h,\theta_{o})$

- 出瞳点直角坐标$(x,y)$对应的位置矢量为$\overrightarrow{r}$，对应的极坐标可写为$(r,\theta)$

即有：
$$\begin{cases}
(x_{o},y_{o})&=h(\cos \theta_{o},\sin \theta_{o})\\
(x,y)&=r(\cos \theta ,\sin \theta)
\end{cases}$$
随系统旋转，有三个不变量：

- 第一个即为$|\overrightarrow{h}|$:
$$|\overrightarrow{h}|=(x_{o}^{2}+y_{o}^{2})^{1/2}$$

- 第二个即为$|\overrightarrow{r}|$:
$$|\overrightarrow{r}|=(x^{2}+y^{2})^{1/2}$$

- 第三个即为$\overrightarrow{h}\cdot \overrightarrow{r}$:
$$\overrightarrow{h}\cdot \overrightarrow{r}=x_{o}x+y_{o}y=|\overrightarrow{h}||\overrightarrow{r}|\cos(\theta-\theta_{o})$$

前面两个不变量很好理解，无论系统怎样旋转，对一支固定光线来讲，其在物点和出瞳面交点的**位置矢量的大小是不发生变化的，只有位置矢量与极轴的夹角在变化。**

第三个不变量需要注意，由于系统具有旋转对称性，物点围绕光轴旋转时，其发出的光线与出瞳面的交点也同样在旋转，二者对应的位置矢量与极轴的夹角均在变化，但是**二者夹角的相对位置是保持不变的**，如若发生变化，则证明系统不具有旋转对称性。

### 对旋转不变量幂次的研究


**考虑到系统的旋转对称性，为了简化计算又不失一般性，做出如下假设：**

  1. 物点$P(x_{o},y_{o})(h,\theta_{o})$位于$x_{o}$轴上，即对于物点坐标，直角坐标可写作$(x_{o},0)$，极坐标可写作$(h,0)$。
  2. 出瞳面上$\theta$的测量是从$x-z$平面为起点开始测量。

综上所述，原始波像差公式为：
$$W(x_{o},y_{o};x,z) \text{or} W(h,\theta_{o};r,\theta)$$

在上面假设的条件下可写作：
$$W(h;x,y) \text{or}W(h;r,\theta)$$



[![坐标系](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)](https://free.picui.cn/free/2025/09/04/68b94b3066fe9.png)

- **$h=0$，轴上物点的情况：**
  
  对于轴上物点来说，光学系统关于光轴的旋转对称性意味着像差函数必须是径向对称的，因此**像差函数$W(h;x,y)$中那些与$h$无关的项必须以$x^{2}+y^{2}$或它的整数次幂的形式出现。在极坐标中，这类与$h$无关的项可以写作$r^{2}$或其整数次幂。**

- **$h\neq 0$，$Q_{1}$、$Q_{2}$处的波像差研究：**
  
  由于$Q_{1}$、$Q_{2}$关于子午平面对称，因此**高度为$h$的物点在出瞳点$Q_{1}$处的波像差**和**高度为$h$的物点在出瞳点$Q_{2}$处的波像差**应该相同。于是则有：

  $$W(h;Q_{1})=W(h;Q_{2})$$
  即：
  $$W(h;x,y)=W(h;x,-y)$$
  以极坐标表示即可得到：
  $$W(h;r,\theta)=W(h;r,-\theta)$$

  因此波像差函数展开式中**依赖$y$的项一定是$y^{2}$及其整数次幂，从极坐标角度，依赖$\theta$的项一定是$\cos \theta$ 的函数。**


- **$Q_{1}$、$Q_{3}$处的波像差研究：**
  
  由于旋转对称性，**高度为$h$的物点在出瞳点$Q_{1}$处的波像差**和**高度为$-h$的物点在出瞳点$Q_{3}$处的波像差**应该相同。于是则有：
  $$W(h;Q_{1})=W(h;Q_{3})$$
  即：
  $$W(h;x,y)=W(-h;-x,-y)$$
  以极坐标表示即可得到：
  $$W(h;r,\theta)=W(-h;r,\pi+\theta)$$

 因此，波像差函数展开式中**不依赖于$\theta$的项一定是$h^{2}r^{2}$或它的整数次幂。**

- **$Q_{3}$、$Q_{4}$处的波像差研究：**

  由于$Q_{3}$、$Q_{4}$关于子午平面对称，因此**高度为$-h$的物点在出瞳点$Q_{3}$处的波像差**和**高度为$h$的物点在出瞳点$Q_{4}$处的波像差**应该相同。于是则有：
  $$W(-h;Q_{3})=W(-h;Q_{4})$$
  即：
  $$W(-h;x,-y)=W(-h;x,y)$$
  $$W(-h;r,\pi+\theta)=W(-h;r,\pi-\theta)$$

  结合：
   $$W(h;r,\theta)=W(-h;r,\pi+\theta)$$

  可得到：
  $$W(h;r,\theta)=W(-h;r,\pi-\theta)$$


  因此，**从极坐标角度，依赖于$\theta$的项一定是$hr\cos \theta$的函数。**

[![波像差的对称性](https://free.picui.cn/free/2025/09/18/68cbce5845ddb.png)](https://free.picui.cn/free/2025/09/18/68cbce5845ddb.png)






### 用旋转不变量展开的像差函数

综合上文，像差函数由含$h^{2}$、$r^{2}$和$hr \cos \theta$因子的项构成。于是有：

$$
\begin{aligned}
W(\vec{h} ;\vec{r}) &= \sum_{l=0}^{\infty}\sum_{p=0}^{\infty}\sum_{m=0}^{\infty} C_{lpm}(h^{2})^{l}(r^{2})^{p}[h r\cos (\theta-\theta_{o})]^{m} \\
&= \sum_{l=0}^{\infty}\sum_{p=0}^{\infty}\sum_{m=0}^{\infty} C_{lpm}h^{2l+m}r^{2p+m}\cos ^{m}\left(\theta-\theta_{o}\right)
\end{aligned}
$$



**当  $2p + m = 0$  时（即所有不含  $r$  的项），其和必须为零**，因为与主光线（ $r = 0$  的情况）相关的像差为零。因此，零度项  $C_{000}$  及诸如  $C_{100}h^2$ 、 $C_{200}h^4$  等项在式（3-31）中不出现；

同时，**二阶项亦不存在**。项  $C_{010}r^2$  表示一个独立于  $h$  的离焦像差：若在略偏焦的平面（即通过图像面的纵向位移）观测图像，该像差可被消除，但这意味着定义像差函数所依据的高斯像点必定有误，故此像差项必须为零。

类似地，**项  $C_{001}hr \cos \theta$  表示一个依赖于  $h$  的波前倾斜像差**：其可通过图像在  $C_{001}Rh$  量级上的横向位移校正，隐含图像放大率为  $M(1 + C_{001}R)$ 。然而，这与图像放大率固定为  $M$  的事实相悖，因此该像差项亦必须为零。综上所述，像差函数的幂级数展开仅包含四阶、六阶、八阶等项，相应的像差分别称为初级像差、二级像差、三级像差等。

继续考虑之前的假设，即物点在$x_{o}$轴上，并用像高替换物高（一般情况下，均使用像高表征波像差展开，本质一样），则波像差幂级数展开可表示为：

$$W(h';r,\theta)=\sum_{l=0}^{\infty}\sum_{n=1}^{\infty}\sum_{m=0}^{\infty}\space_{2l+m}a_{nm}h'^{2l+m}r^{n}\cos^{m}\theta$$

这里,
$$\boxed{n=2p+m}$$

为正整数，即不为0（原因见上文，主光线没有像差）

$h'$是高斯像面像点高度，$\space_{2l+m}a_{nm}$是展开系数。

$n-m=2p \geq 0$，且为偶数。

**像差级次$i$等于物点坐标与瞳面坐标幂级次之和。**
$$\boxed{i=2l+m+n=2(l+p+m)}$$
从上式明显看出，$i$是偶数。

现在研究一个重要问题，即**对于同样一个$i$，有多少个$l、m、n$组合？**

梳理一下该问题的前提条件：
- $i=2l+m+n=2(l+m+p)$
- $n-m=2p \geq 0$，即$n\geq m$且$n-m$是偶数

$$\because i=2l+m+n$$
固定$i$时，$l$可以由$m$，$n$进行确定：
$$l=\frac{i-(m+n)}{2}$$
要求$l\neq 0$，则有：
$$m+n\leq i,m+n=i$$
则问题转化为：

$$\begin{cases}
m+n&\leq i\\
n&\equiv m(\text{mod}2)\\
n &\geq m
\end{cases}$$

在整数点阵里满足$m,n\geq 0,n\geq m,m+n\leq i$且$m+n$与$i$同奇偶的点的个数。

[![取点示意图](https://free.picui.cn/free/2025/09/22/68d0da1874dec.png)](https://free.picui.cn/free/2025/09/22/68d0da1874dec.png)

最终得到组合的数量应该满足：
$$N_{i}=\frac{(i+2)(i+4)}{8}$$

- 当$i=2$时
  $$N_{2}=\frac{(2+2)(2+4)}{8}=3$$
  满足$2l+m+n=2$，且$n-m$为偶数的项**共有3项**。
  - **$l=1,m=0,n=0$**
  
    代入波像差幂级数展开式可得：
    - $h'^{2}$： 被排除，因为主光线上必须像差为零。
  - **$l=0,m=0,n=2$**
  
    代入波像差幂级数展开式可得：
    - $r^{2}$：离焦（可通过像面平移消去）。
  - **$l=0,m=1,n=1$**
  
    代入波像差幂级数展开式可得：
    - $h'r\cos \theta$：波前倾斜（可通过横向移像消去）。

- 当$i=4$时
  $$N_{4}=\frac{(4+2)(4+4)}{8}=6$$
  满足$2l+m+n=4$，且$n-m$为偶数的项**共有6项**。
  - **$l=2,m=0,n=0$**

    代入波像差幂级数展开式可得：
    - $h'^{4}$：被排除，因为主光线上必须像差为零。
  
  - **$l=1,m=0,n=2$**
  
     代入波像差幂级数展开式可得：

     - $h'^{2}r^{2}$：**场曲**
  
  - **$l=0,m=0,n=4$**

    代入波像差幂级数展开式可得：

    - $r^{4}$：**球差**

  - **$l=1,m=1,n=1$**
  
    代入波像差幂级数展开式可得：
    - $h'^{3}r\cos \theta$：**畸变**
  - **$l=0,m=1,n=3$**
    代入波像差幂级数展开式可得：
    - $h'r^{3}\cos \theta$：**慧差**
  - **$l=0,m=2,n=2$**
    代入波像差幂级数展开式可得：
    - $h'^{2}r^{2}\cos \theta$：**像散**

  
| l | n | m | Aberration Term                       | Aberration Name |
| - | - | - | ------------------------------------- | --------------- |
| 0 | 4 | 0 | ${}_{0}a_{40} r^4$                    | Spherical       |
| 0 | 3 | 1 | ${}_{1}a_{31} h' r^3 \cos \theta$     | Coma            |
| 0 | 2 | 2 | ${}_{2}a_{22} h'^2 r^2 \cos^2 \theta$ | Astigmatism     |
| 1 | 2 | 0 | ${}_{2}a_{20} h'^2 r^2$               | Field curvature |
| 1 | 1 | 1 | ${}_{3}a_{11} h'^3 r \cos \theta$     | Distortion      |





