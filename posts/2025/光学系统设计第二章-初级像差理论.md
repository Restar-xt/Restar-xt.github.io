---
title: 光学系统设计第二章①-初级像差理论
tags: [Zemax]
categories: [光学设计基础]
date: 2025-8-7
description: 本笔记参考浙江大学-李晓彤老师-光学系统设计课程
articleGPT: 这是光学系统设计第二章笔记，本章目的是利用哈密顿表述，导出旋转对称光学系统的像差表达式。理解初级像差的概念、现象、与孔径视场的关系。
references:
  - title: 浙江大学光学系统设计 李晓彤老师 2025春夏学期
  - url: https://classroom.zju.edu.cn/livingroom?course_id=72005&sub_id=1539825&tenant_code=112
   
---


# 光学系统设计第二章 初级像差理论

> **参考书目：**  
> 《工程光学》（第4版）                 &ensp;      郁道银 谈恒英  
> 《几何光学·像差·光学设计》（第5版）         &ensp;&ensp;&ensp;&ensp; 李晓彤 岑兆丰
>
> **参考视频：**\
> 学在浙大-智云学堂-李晓彤老师《光学系统设计》 2024-2025-2 工程师学院
>
> **课程概述：**\
> 主要围绕原理、设计要求与设计方法。主要包括绪论、高斯光学、初级像差理论、光学系统结构设计、光学系统质量评价、光学系统中的特殊面形或元件、特殊光学系统设计。

## 初级像差的表达式

### 如何确定一条光线？

旋转对称系统的哈密顿量
$$H=-\sqrt{n^{2}(u,z)-v}$$
其中：
$$u=x^{2}+y^{2}$$
$$v=p^{2}+q^{2}$$

规定大写表示实际光线，小写表示近轴光线
$$H=-\sqrt{n^{2}(U,z)-V}$$

>由于旋转对称性，可以先研究关于$x$与$p$的方程，同理可得$y$与$q$的方程。
>$$
\because
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial u}{\partial x}=2x\\
\frac{\partial v}{\partial p}=2p
\end{aligned}
\end{array}
\right.
>$$
>$$
\therefore
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial }{\partial x}=2x\frac{\partial}{\partial u}\\
\space \\
\frac{\partial }{\partial p}=2p\frac{\partial}{\partial p}
\end{aligned}
\end{array}
\right.
>$$
>由前一节的哈密顿方程得到的结论：
>$$
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial H}{\partial p} &= \dot{x} \\
\frac{\partial H}{\partial q} &= \dot{y} \\
\frac{\partial H}{\partial x} &= -\dot{p} \\
\frac{\partial H}{\partial y} &= -\dot{q} \\
\frac{\partial H}{\partial z} &= -\frac{\partial L}{\partial z}
\end{aligned}
\end{array}
\right.
>$$
>则可得到：
>$$\dot{x}=\frac{\partial H}{\partial p}=2p\frac{\partial H}{\partial v}=2pH_{2}$$
>$$\dot{p}=-\frac{\partial H}{\partial x}=-2x\frac{\partial H}{\partial u}=-2xH_{1}$$

$$\frac{\mathrm{d}X}{\mathrm{d}z}=2P\frac{\mathrm{d}H}{\mathrm{d}V}$$
$$\frac{\mathrm{d}P}{\mathrm{d}z}=-2X\frac{\mathrm{d}H}{\mathrm{d}U}$$


回顾第一章的光学余弦（广义光学动量），光学余弦$p$与$q$即是折射率乘方向余弦，指明了光线的方向。若是确定光线初始的位置，即可确定一条光线；另外通过光线在两个平面的位置坐标，结合光沿直线传播即可确定一条光线。

综上，有**两种方式**唯一确定一条光线。

- **某平面上的$X$，$Y$，$P$，$Q$值（一个点位置+方向）**
- **两个平面上的$X$，$Y$值（两个点位置确定）**

### 研究物面到瞳面的光线

|  | 物平面 | 入瞳面 |
|---------|---------|---------|
| 平面位置 | $z=z_{0}$ | $z=\zeta$ |
| 光线表示 | $X(z_{0})=x_{0}$<br>$Y(z_{0})=y_{0}$ | $X(\zeta)=\xi$<br>$Y(\zeta)=\eta$ |


则光线传播到任意位置时的$X$，$Y$，$P$，$Q$均是关于$x_{0}$，$y_{0}$，$\xi$，$\eta$的函数。对于任意光线，将$X$，$Y$，$P$，$Q$级数展开，仍以$X$，$P$为例：
$$X=X_{1}+X_{2}+X_{3}+\dots$$
$$P=P_{1}+P_{2}+P_{3}+\dots$$
其中$X_{1}$、$P_{1}$为一次项，同理依次递增。但要注意 **<font color = red>没有零次项即常数项</font>** 。假设光线初始坐标为$(0,0)$，即光线出发点位于物面与光轴交点处，并沿光轴传播，若有零次项，则说明光线在传播后将会偏离光轴，与实际不符。

由于系统旋转对称，由$x_{0}$，$y_{0}$，$\xi$，$\eta$决定的光线在某个面上有$X(z_{1})$、$Y(z_{1})$、$P(z_{1})$、$Q(z_{1})$；而由$-x_{0}$，$-y_{0}$，$-\xi$，$-\eta$决定的光线在该面上有$-X(z_{1})$、$-Y(z_{1})$、$-P(z_{1})$、$-Q(z_{1})$。但要注意 **<font color = red>没有偶次项</font>**。若含有偶次项，那么在光线传播的某个面处有：
$$X(z_{1})=X_{1}(z_{1})+X_{2}(z_{1})$$
$$-X(z_{1})=-X_{1}(z_{1})-X_{2}(z_{1})$$
但$X_{2}(z_{1})\neq 0$，那么这与系统的旋转对称性相矛盾，即对称光线在同一面上的交点不再对称。故没有偶次项。

### 像差级次
- 当$x_{0}$，$y_{0}$，$\xi$，$\eta$为无限小时，高次项可以忽略，仅有线性项，即得到高斯光学，没有像差。
- $X=X_{1}+X_{2}+X_{3}+\dots$ 没有偶次项，即偶次项为0，不对像差有贡献。
- 故而$X_{3}$、$P_{3}$为初级像差，$X_{5}$、$P_{5}$为二级像差。

综上所述，将$X$，$Y$，$P$，$Q$级数展开最终整理得到的形式为：
$$X=X_{1}+X_{3}+X_{5}+\dots$$
$$P=P_{1}+P_{3}+P_{5}+\dots$$

> 注意，有的文献按照$X_{3}$的级数级次为3，也成为三级像差，实质上只是换了个名字。**Primary aberration**（初级像差）、**The third-order aberration**（三阶像差）、**Seidel aberration**（赛德尔像差）均指的同一个东西，即$X_{3}$、$P_{3}$...

## 初级像差的计算

### 方程推导
 将哈密顿量$H$在$U=0,V=0$处进行泰勒级数展开，即得到：
 $$H=H_{0}+H_{1}U+H_{2}V+\frac{1}{2}(H_{11}U^{2}+H_{22}V^{2}+2H_{12}UV)+\dots $$
 各项泰勒系数均为$z$的函数。
 由哈密顿方程得出的结论：
 $$\dot{X}=\frac{\partial H}{\partial P}$$
 $$\frac{\partial X}{\partial z}=2P\frac{\partial H}{\partial V}$$
那么则按照哈密顿量$H$的泰勒展开式，并结合上述公式进行计算可得：
 $$\dot{X_{1}}=2P_{1}(H_{2}+H_{12}U+H_{22}V+\dots)$$
 则有:
 $$\dot{X_{1}}+\dot{X_{3}}+\dots=2(P_{1}+P_{3}+\dots)(H_{2}+H_{12}U+H_{22}V+\dots)$$
 另一方面：
 $$U=X^{2}+Y^{2}=(X_{1}+X_{3}+\dots)^{2}+(Y_{1}+Y_{3}+\dots)^{2}=U_{1}+2(X_{1}X_{3}+Y_{1}Y_{3})+\dots$$
 $$V=P^{2}+Q^{2}=(P_{1}+P_{3}+\dots)^{2}+(Q_{1}+Q_{3}+\dots)^{2}=V_{1}+2(P_{1}P_{3}+Q_{1}Q_{3})+\dots$$
 将$U$，$V$代入，并令两边同次项相等，则可得到：
$$
\begin{aligned}
\dot{X_{1}} + \dot{X_{3}} + \cdots 
&= 2(P_{1} + P_{3} + \cdots)\bigg(H_{2} + H_{12}\big(U_{1} + 2(X_{1}X_{3} + Y_{1}Y_{3}) + \cdots\big) + H_{22}\big(V_{1} + 2(P_{1}P_{3} + Q_{1}Q_{3}) + \cdots\big) + \cdots\bigg) \\
&= 2(P_{1} + P_{3} + \cdots)H_{2} \\
&\quad + 2(P_{1} + P_{3} + \cdots)H_{12}U_{1} \\
&\quad + 4(P_{1} + P_{3} + \cdots)H_{12}(X_{1}X_{3} + Y_{1}Y_{3}) \\

&\quad + 2(P_{1} + P_{3} + \cdots)H_{22}V_{1} \\
&\quad + 4(P_{1} + P_{3} + \cdots)H_{22}(P_{1}P_{3} + Q_{1}Q_{3}) \\

\end{aligned}
$$

首先分析上式中所含符号的阶数：

| 分量             | 阶数   |
|------------------|--------|
| $X_1, P_1$       | 一阶   |
| $X_3, P_3$       | 三阶   |
| $U_1 = X_1^2 + Y_1^2$ | 二阶   |
| $V_1 = P_1^2 + Q_1^2$ | 二阶   |
| $H_{12}, H_{22}$     | 零阶   |

等式两边同样阶数的项应相等（导数阶数不变，类似微扰理论）
则有：
$$
\begin{aligned}
\dot{X_{1}} &= 2H_{2}P_{1} \\
\dot{X_{3}} &= 2H_{2}P_{3} + 2(H_{12}U_{1} + H_{22}V_{1})P_{1} \\
\dot{P_{1}} &= -2H_{1}X_{1} \\
\dot{P_{3}} &= -2H_{1}X_{3} - 2(H_{11}U_{1} + H_{12}V_{1})X_{1}
\end{aligned}
$$
同理则有：
$$
\begin{aligned}
\dot{Y}_{1} &= 2 H_{2} Q_{1} \\
\dot{Y}_{3} &= 2 H_{2} Q_{3} + 2\left(H_{12} U_{1} + H_{22} V_{1}\right) Q_{1} \\
\dot{Q}_{1} &= -2 H_{1} Y_{1} \\
\dot{Q}_{3} &= -2 H_{1} Y_{3} - 2\left(H_{11} U_{1} + H_{12} V_{1}\right) Y_{1}
\end{aligned}
$$

> **近轴方程：**
> $$
\begin{aligned}
\dot{X_{1}} &= 2H_{2}P_{1} \\
\dot{P_{1}} &= -2H_{1}X_{1} \\
\end{aligned}
$$

> **初级像差方程：**
> $$
\begin{aligned}
\dot{X_{3}} &= 2H_{2}P_{3} + 2(H_{12}U_{1} + H_{22}V_{1})P_{1} \\
\dot{P_{3}} &= -2H_{1}X_{3} - 2(H_{11}U_{1} + H_{12}V_{1})X_{1}
\end{aligned}
$$

### 理论计算像差方法
 1.写出折射率方程

 2.求解$H_{i}$，$H_{ij}$

 3.求解近轴解；初级像差

 ### 近轴解
 - **考虑两条近轴光线：第一近轴光**

 ![示意图](https://picui.cn/thumbnails/36003932deeea17a871e4dad468cc45d.png)

 **轴上物点发出，经过入瞳边缘的光线：**

 起始坐标：$X_{1}(Z_{0})=0\space,\space Y_{1}(Z_{0})=0$

 瞳面坐标：$X_{1}(\varsigma)=1\space,\space Y_{1}(\varsigma)=0$

 给出解（代表解）：
 $$\boxed{X_{1}(z)=g(z)\space ,\space p_{1}(z)=\theta(z)}$$
 且有边界条件：
 $$\boxed{g(z_{0})=0\space , \space g(\varsigma)=1}$$

 - **考虑两条近轴光线：第二近轴光**

 ![示意图](https://picui.cn/thumbnails/36003932deeea17a871e4dad468cc45d.png)

 **轴外物点发出，经过入瞳中心的光线：**

 起始坐标：$X_{1}(z_{0})=1\space,\space Y_{1}(z_{0})=0$

 瞳面坐标：$X_{1}(\varsigma)=0\space,\space Y_{1}(\varsigma)=0$

 给出解（代表解）：
 $$\boxed{X_{1}(z)=G(z)\space , \space P_{1}(z)=\Theta(z)}$$
 且有边界条件：
 $$\boxed{G(z_{0})=1 \space , \space G(\varsigma)=0}$$
::: danger
  **$g(z),G(z),\theta(z),\Theta(z)$是近轴方程组两个线性独立的解，其他解均可以表示为这两个解的线性组合。**
:::
  现在考虑近轴解中的**一般情况：**

 起始坐标：$(x_{0},y_{0})$

 瞳面坐标：$(\xi ,\eta)$

 则近轴解为：
 $$\boxed{X_{1}(z)=x_{0}G(z)+\xi g(z)}$$
 $$\boxed{Y_{1}(z)=y_{0}G(z)+\eta g(z) }$$

 另外，$g(z),G(z),\theta(z),\Theta(z)$依旧满足哈密顿方程中推导的关系式：
 >由于旋转对称性，可以先研究关于$x$与$p$的方程，同理可得$y$与$q$的方程。
>$$
\because
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial u}{\partial x}=2x\\
\frac{\partial v}{\partial p}=2p
\end{aligned}
\end{array}
\right.
>$$
>$$
\therefore
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial }{\partial x}=2x\frac{\partial}{\partial u}\\
\space \\
\frac{\partial }{\partial p}=2p\frac{\partial}{\partial p}
\end{aligned}
\end{array}
\right.
>$$
>由前一节的哈密顿方程得到的结论：
>$$
\left\{
\begin{array}{l}
\begin{aligned}
\frac{\partial H}{\partial p} &= \dot{x} \\
\frac{\partial H}{\partial q} &= \dot{y} \\
\frac{\partial H}{\partial x} &= -\dot{p} \\
\frac{\partial H}{\partial y} &= -\dot{q} \\
\frac{\partial H}{\partial z} &= -\frac{\partial L}{\partial z}
\end{aligned}
\end{array}
\right.
>$$
>则可得到：
>$$\dot{x}=\frac{\partial H}{\partial p}=2p\frac{\partial H}{\partial v}=2pH_{2}$$
>$$\dot{p}=-\frac{\partial H}{\partial x}=-2x\frac{\partial H}{\partial u}=-2xH_{1}$$

故而有：

$$\begin{align*}
\frac{\mathrm{d}g}{\mathrm{d}z} &= 2\theta H_{2} \\
\frac{\mathrm{d}\theta}{\mathrm{d}z} &= -2g H_{1} \\
\frac{\mathrm{d}G}{\mathrm{d}z} &= 2\Theta H_{2} \\
\frac{\mathrm{d}\Theta}{\mathrm{d}z} &= -2G H_{1}
\end{align*}
$$

于是，根据$X_{1}(z)$，$Y_{1}(z)$的表达式结合哈密顿方程得到的关系可得到$P_{1}(z)$，$Q_{1}(z)$的表达式：
$$P_{1}(z)=\frac{1}{2H_{2}}\dot{X_{1}}=\frac{1}{2H_{2}}\Big(x_{0}\dot{G}(z)+\xi\dot{\theta}(z)\Big)=x_{0}\Theta(z)+\xi \theta(z)$$
同理，
$$Q_{1}(z)=y_{0}\Theta(z)+\eta \theta(z)$$

**综上所述；**
$$X_{1}(z)=x_{0}G(z)+\xi g(z)$$
$$P_{1}(z)=x_{0}\Theta(z)+\xi \theta(z)$$
$$Y_{1}(z)=y_{0}G(z)+\eta g(z)$$
$$Q_{1}(z)=y_{0}\Theta(z)+\eta \theta(z)$$



### 初级像差（$X_{3}$）

设$z=z_{0}$处轴上点发出理想光线，用$g(z)$表示，两条光线(一条第一近轴光，另一条为沿光轴的光)交点为高斯像点，设高斯像点位于$z=z_{1}$处。显然：
$$g(z_{1})=0,z_{1}\neq z_{0}$$
因此在高斯像面上有：
$$X_{1}(z_{1})=x_{0}G(z_{1})$$
$X_{1}(z_{1})$与$\xi$，$\eta$无关，$G$其实就是放大率。

现在研究初级像差，考虑这样一条光线：

起始坐标：$(x_{0},y_{0},z_{0})$

瞳面坐标：$(\xi\space,\space\eta\space,\space\zeta)$

边界条件：

$$
\boxed{
\begin{aligned}
X_{1}(z_{0}) &= x_{0}, & Y_{1}(z_{0}) &= y_{0} \\
X_{1}(z_{1}) &= \xi,   & Y_{1}(z_{1}) &= \eta
\end{aligned}
}
$$

又根据哈密顿方程有：
$$\begin{align*}
\frac{\mathrm{d}g}{\mathrm{d}z} &= 2\theta H_{2} \\
\frac{\mathrm{d}\theta}{\mathrm{d}z} &= -2g H_{1} \\
\frac{\mathrm{d}G}{\mathrm{d}z} &= 2\Theta H_{2} \\
\frac{\mathrm{d}\Theta}{\mathrm{d}z} &= -2G H_{1}
\end{align*}
$$
可得：
$$
\begin{align*}
2H_{2} &= \frac{\dot{g}}{\theta} \\
2H_{1} &= -\frac{\dot{\theta}}{g}
\end{align*}
$$
结合初级像差方程：
$$
\begin{aligned}
\dot{X_{1}} &= 2H_{2}P_{1} \\
\dot{X_{3}} &= 2H_{2}P_{3} + 2(H_{12}U_{1} + H_{22}V_{1})P_{1} \\
\dot{P_{1}} &= -2H_{1}X_{1} \\
\dot{P_{3}} &= -2H_{1}X_{3} - 2(H_{11}U_{1} + H_{12}V_{1})X_{1}
\end{aligned}
$$

则可得到：
$$
\boxed{
\begin{aligned}
\dot{X_{3}} &= 2H_{2}P_{3} + 2(H_{12}U_{1} + H_{22}V_{1})P_{1}\\
&=\frac{\dot{g}}{\theta} P_{3} + 2(H_{12}U_{1} + H_{22}V_{1})P_{1}
\end{aligned}}
$$

$$
\boxed{
\begin{aligned}
\dot{P_{3}} &= -2H_{1}X_{3} - 2(H_{11}U_{1} + H_{12}V_{1})X_{1}\\
&=\frac{\dot{\theta}}{g}X_{3} - 2(H_{11}U_{1} + H_{12}V_{1})X_{1}
\end{aligned}}
$$

即：

$$
\boxed{
\begin{aligned}
&\dot{X_{3}}\theta - \dot{g}P_{3} = 2(H_{12}U_{1} + H_{22}V_{1})P_{1}\theta \\
&X_{3}\dot{\theta} - g\dot{P_{3}} = 2(H_{11}U_{1} + H_{12}V_{1})X_{1}g
\end{aligned}
}
$$

观察上式，两个式子左边相加其实就是$(X_{3}\theta-gP_{3})$对$z$求导的结果，因此有：
$$\frac{\mathrm{d}}{\mathrm{d}z}(X_{3}\theta-gP_{3})=2\bigg[(H_{12}U_{1} + H_{22}V_{1})P_{1}\theta+2(H_{11}U_{1} + H_{12}V_{1})X_{1}g\bigg]$$
将上式从物面到像面进行积分：
$$(X_{3}\theta-gP_{3})\bigg|^{z_{1}}_{z_{0}}=2\int^{z_{1}}_{z_{0}}\bigg[(H_{12}U_{1} + H_{22}V_{1})P_{1}\theta+2(H_{11}U_{1} + H_{12}V_{1})X_{1}g\bigg]\mathrm{d}z$$
利用 ${g(z_{0})=0}$, ${X_{3}(z_{0})=0}$, ${g(z_{1})=0}$ 得**像面上沿$x$方向的像差**：


$$
X_{3}(z_{1}) = \frac{2}{\theta(z_{1})} \int_{z_{0}}^{z_{1}} 
\biggl[
(H_{12} U_{1} + H_{22} V_{1}) P_{1}\theta + 
(H_{11} U_{1} + H_{12} V_{1}) X_{1} g
\biggr] \mathrm{d} z
$$

同理可得**像面上沿$y$方向的像差**:
$$Y_{3}(z_{1}) = \frac{2}{\theta(z_{1})} \int_{z_{0}}^{z_{1}} 
\biggl[
(H_{12} U_{1} + H_{22} V_{1}) Q_{1}\theta + 
(H_{11} U_{1} + H_{12} V_{1}) Y_{1} g
\biggr] \mathrm{d} z$$

又因为：
$$U_{1} = X_{1}^{2} + Y_{1}^{2} = \bigl[x_{0} G(z) + \xi g(z)\bigr]^{2} + 
\bigl[y_{0} G(z) + \eta g(z)\bigr]^{2} = rG^{2} + 2tGg + sg^{2}$$
这里 
$$r = x_{0}^{2} + y_{0}^{2}$$
$$t = x_{0}\xi + y_{0}\eta$$
$$s = \xi^{2} + \eta^{2}$$

同样：
$$V_{1} = P_{1}^{2} + Q_{1}^{2} = r\Theta^{2} + 2t\Theta\theta + s\theta^{2}$$
代入积分式可得：
$$\begin{cases} 
X_{3}(z_{1}) = \bigg[As + 2Bt + (C+D)r\bigg]\xi + \bigg[Bs + 2Ct + Er\bigg]x_{0} \\ 
\space \\
Y_{3}(z_{1}) = \bigg[As + 2Bt + (C+D)r\bigg]\eta + \bigg[Bs + 2Ct + Er\bigg]y_{0} 
\end{cases}$$

$A$，$B$，$C$，$D$，$E$为像差系数。
$$
\begin{aligned}
& A=\dfrac{2}{\theta\left(z_{1}\right)}\int_{z_{1}}^{z_{2}}\left[H_{11} g^{4}+2H_{12} g^{2}\theta^{2}+H_{22}\theta^{4}\right]\mathrm{d}z \\
& B=\dfrac{2}{\theta\left(z_{1}\right)}\int_{z_{1}}^{z_{2}}\left[H_{12} Gg^{3}+H_{12}g\theta(g\Theta+G\theta)+H_{22}\Theta\theta^{3}\right]\mathrm{d}z \\
& C=\dfrac{2}{\theta\left(z_{1}\right)}\int_{z_{1}}^{z_{2}}\left[H_{11} G^{2}g^{2}+2H_{12} Gg\Theta\theta+H_{22}\Theta^{2}\theta^{2}\right]\mathrm{d}z \\
& D=\dfrac{2}{\theta\left(z_{1}\right)}\Gamma^{2}\int_{z_{1}}^{z_{2}} H_{12}\mathrm{d}z \\
& E=\dfrac{2}{\theta\left(z_{1}\right)}\int_{z_{1}}^{z_{2}}\left[H_{11} G^{3}g+H_{12} G\Theta(g\Theta+G\theta)+H_{22}\Theta^{3}\theta\right]\mathrm{d}z 
\end{aligned}
$$

其中，  
$$ \Gamma=G\theta-g\Theta $$  

$z=z_{0}$ 点  
$$ \Gamma=nX_{1}(z_{0})u-0 $$  

$z=z_{1}$ 点  
$$ \Gamma=n^{\prime}X_{1}(z_{1})u^{\prime}-0 $$

在其他各点：
$$ \frac{\mathrm{d} \Gamma}{\mathrm{d}  z}=G \dot{\theta}+G \ddot{\theta}-g \dot{\Theta}-g \dot{\Theta}=2H_{2} \Theta \theta+G(-2H_{1} g)-2H_{2} \Theta \theta-g(-2 H_{1} G)=0 $$  
